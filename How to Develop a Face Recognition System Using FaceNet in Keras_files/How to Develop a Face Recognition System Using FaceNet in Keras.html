<!DOCTYPE html>
<!-- saved from url=(0121)https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/ -->
<html lang="en-US" style="min-height: 100%;" class="js csstransforms3d csstransitions gr__machinelearningmastery_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">



<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php">

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

<!-- This site is optimized with the Yoast SEO plugin v12.7.1 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Develop a Face Recognition System Using FaceNet in Keras</title>
<meta name="robots" content="max-snippet:-1, max-image-preview:large, max-video-preview:-1">
<link rel="canonical" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="How to Develop a Face Recognition System Using FaceNet in Keras">
<meta property="og:description" content="Face recognition is a computer vision task of identifying and verifying a person based on a photograph of their face. FaceNet is a face recognition system developed in 2015 by researchers at Google that achieved then state-of-the-art results on a range of face recognition benchmark datasets. The FaceNet system can be used broadly thanks to …">
<meta property="og:url" content="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/">
<meta property="article:author" content="https://www.facebook.com/jason.brownlee.39">
<meta property="article:section" content="Deep Learning for Computer Vision">
<meta property="article:published_time" content="2019-06-06T19:00:22+00:00">
<meta property="article:modified_time" content="2019-11-21T22:11:20+00:00">
<meta property="og:updated_time" content="2019-11-21T22:11:20+00:00">
<meta property="og:image" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier.png">
<meta property="og:image:secure_url" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier.png">
<meta property="og:image:width" content="1280">
<meta property="og:image:height" content="960">
<script id="twitter-wjs" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/widgets.js"></script><script type="text/javascript" async="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/client.js"></script><script id="twitcount_plugins" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/twitcount.js"></script><script type="text/javascript" async="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/9556588.js"></script><script type="text/javascript" async="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/js"></script><script type="text/javascript" async="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/analytics.js"></script><script type="application/ld+json" class="yoast-schema-graph yoast-schema-graph--main">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/company/machine-learning-mastery","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#logo","url":"https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#logo"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","description":"Making developers awesome at machine learning","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":{"@type":"SearchAction","target":"https://machinelearningmastery.com/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"ImageObject","@id":"https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#primaryimage","url":"https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier.png","width":1280,"height":960,"caption":"Detected Face of Jerry Seinfeld, Correctly Identified by the SVM Classifier"},{"@type":"WebPage","@id":"https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#webpage","url":"https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/","inLanguage":"en-US","name":"How to Develop a Face Recognition System Using FaceNet in Keras","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#primaryimage"},"datePublished":"2019-06-06T19:00:22+00:00","dateModified":"2019-11-21T22:11:20+00:00"},{"@type":"Article","@id":"https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#article","isPartOf":{"@id":"https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#webpage"},"author":{"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8"},"headline":"How to Develop a Face Recognition System Using FaceNet in Keras","datePublished":"2019-06-06T19:00:22+00:00","dateModified":"2019-11-21T22:11:20+00:00","commentCount":"173","mainEntityOfPage":{"@id":"https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#webpage"},"publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#primaryimage"},"articleSection":"Deep Learning for Computer Vision"},{"@type":["Person"],"@id":"https://machinelearningmastery.com/#/schema/person/e2d0ff4828d406a3b47e5a3c9a0591e8","name":"Jason Brownlee","image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#authorlogo","url":"https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["https://www.facebook.com/jason.brownlee.39","https://twitter.com/teachthemachine"]}]}</script>
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="https://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="https://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » How to Develop a Face Recognition System Using FaceNet in Keras Comments Feed" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.3.2"}};
			!function(e,a,t){var r,n,o,i,p=a.createElement("canvas"),s=p.getContext&&p.getContext("2d");function c(e,t){var a=String.fromCharCode;s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,e),0,0);var r=p.toDataURL();return s.clearRect(0,0,p.width,p.height),s.fillText(a.apply(this,t),0,0),r===p.toDataURL()}function l(e){if(!s||!s.fillText)return!1;switch(s.textBaseline="top",s.font="600 32px Arial",e){case"flag":return!c([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])&&(!c([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!c([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]));case"emoji":return!c([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340])}return!1}function d(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(i=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},o=0;o<i.length;o++)t.supports[i[o]]=l(i[o]),t.supports.everything=t.supports.everything&&t.supports[i[o]],"flag"!==i[o]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[i[o]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(r=t.source||{}).concatemoji?d(r.concatemoji):r.wpemoji&&r.twemoji&&(d(r.twemoji),d(r.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/wp-emoji-release.min.js" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="crayon-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="simple-sitemap-css-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/simple-sitemap.css" type="text/css" media="all">
<link rel="stylesheet" id="contact-form-7-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/styles.css" type="text/css" media="all">
<link rel="stylesheet" id="ssb-front-css-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/front.css" type="text/css" media="all">
<link rel="stylesheet" id="ewd-ufaq-style-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/ewd-ufaq-styles.css" type="text/css" media="all">
<link rel="stylesheet" id="ewd-ufaq-rrssb-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/rrssb-min.css" type="text/css" media="all">
<link rel="stylesheet" id="woo-testimonials-css-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/testimonials.css" type="text/css" media="all">
<link rel="stylesheet" id="theme-stylesheet-css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/style.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/jquery.js"></script>
<script type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/crayon.min.js"></script>
<script type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/front.js"></script>
<script type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/third-party.min.js"></script>
<script type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/modernizr.min.js"></script>
<script type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/general.min.js"></script>
<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://machinelearningmastery.com/?p=7815">
<link rel="alternate" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier%2F">
<link rel="alternate" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fhow-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier%2F&amp;format=xml">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/js(1)"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'UA-44039733-3', { 'optimize_id': 'GTM-MV6J2DK'});
</script>
 <style media="screen">

		.simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
	  margin: ;
	}
		 /*inline margin*/
	
	
	
	
	
	
			 .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
		 margin: ;
	 }

			 /*margin-digbar*/

	
	
	
	
	
	
	
</style>
    <script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>

<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 15px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#eeeeee!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#84abc7!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#84abc7;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Custom Favicon -->
<link rel="shortcut icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/09/icon-16x16.png">

<!-- Woo Shortcodes CSS -->
<link href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/shortcodes.css" rel="stylesheet" type="text/css">

<!-- Custom Stylesheet -->
<link href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/custom.css" rel="stylesheet" type="text/css">

<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
		<style type="text/css" id="wp-custom-css">
			.display-posts-listing.image-left .listing-item {
	overflow: hidden; 
	margin-bottom: 30px;
	width: 100%;
}

.display-posts-listing.image-left .image {
	float: left;
	margin: 0 10px 0 0;
}

.display-posts-listing.image-left .attachment-thumbnail {
	height: auto; 
	width: auto; 
	max-width: 50px; 
	max-height: 50px;
	border-radius: 50%;
}

.display-posts-listing.image-left .title {
	display: block;
}

.display-posts-listing.image-left .excerpt-dash { 
	display: none; 
}

.display-posts-listing.image-left {
	margin: 0 0 40px 0;
}		</style>
		<script src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/can-i-show.js"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}  .fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><script src="chrome-extension://mooikfkahbdckldjjndioackbalphokd/assets/prompt.js"></script><link rel="stylesheet" type="text/css" href="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/twitcount.css" media="all"><style type="text/css">
  /* === Form-Specific Styles === */
  /* stylelint-disable */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(116,174,203) !important;
    background: rgba(116,174,203,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-content .classic--checkbox,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab div,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px 15px 12px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Powered By === */

  .drip-tab .drip-powered-by {
    padding: 8px;
    margin-bottom: -5px;
    font-family: Helvetica, Arial, sans-serif;
    text-align: left;
    font-weight: bold;
    font-size: 10px;
    line-height: 16px;
    color: #ffffff;
    letter-spacing: 1px;
    text-align: center;
    text-transform: uppercase;
    display: -webkit-box;
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .drip-tab .drip-powered-by a {
    color: #ffffff !important;
    text-decoration: underline !important;
    letter-spacing: 1px;
    margin-left: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-tab .drip-text-field {
    margin: 0 !important;
    padding: 6px !important;
    height: auto !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

  /* checkbox */
  .drip-tab .classic--checkbox.hidden {
    margin-bottom: -8px;
    display: none;
  }

  .drip-tab .classic--checkbox input[type="checkbox"] {
    display: inline-block;
    width: auto;
  }

  /* stylelint-enable */

</style></head>
<body class="post-template-default single single-post postid-7815 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960" data-gr-c-s-loaded="true">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/Header_smaller_text_better-1.png" alt="Machine Learning Mastery"></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="custom_html-33" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: right;">
	<a href="https://machinelearningmastery.lpages.co/dlfcv-mini-course/">Click to Take the FREE Computer Vision Crash-Course</a>
</div></div></div><div id="search-4" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}">
		<input type="hidden" name="post_type" value="post">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Get Started</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506 parent"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">NLP (Text)</a></li>
	<li id="menu-item-8576" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8576"><a href="https://machinelearningmastery.com/category/generative-adversarial-networks/">GANs</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Deep Learning Performance</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Intro to Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Intro to Time Series</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistics</a></li>
	<li id="menu-item-8989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-8989"><a href="https://machinelearningmastery.com/category/probability/">Probability</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">EBooks</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-7815 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning-for-computer-vision">
	<header>
	<h1 class="title entry-title">How to Develop a Face Recognition System Using FaceNet in Keras</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2019-06-07T05:00:22+1000">June 7, 2019</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/" title="View all items in Deep Learning for Computer Vision">Deep Learning for Computer Vision</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-7815 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+a+Face+Recognition+System+Using+FaceNet+in+Keras&amp;url=https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p class="post-last-modified">Last Updated on <time class="post-last-modified-td">November 22, 2019</time></p><p><a href="https://machinelearningmastery.com/introduction-to-deep-learning-for-face-recognition/">Face recognition</a> is a computer vision task of identifying and verifying a person based on a photograph of their face.</p>
<p>FaceNet is a face recognition system developed in 2015 by researchers at Google that achieved then state-of-the-art results on a range of face recognition benchmark datasets. The FaceNet system can be used broadly thanks to multiple third-party open source implementations of the model and the availability of pre-trained models.</p>
<p>The FaceNet system can be used to extract high-quality features from faces, called face embeddings, that can then be used to train a face identification system.</p>
<p>In this tutorial, you will discover how to develop a face detection system using FaceNet and an SVM classifier to identify people from photographs.</p>
<p>After completing this tutorial, you will know:</p>
<ul>
<li>About the FaceNet face recognition system developed by Google and open source implementations and pre-trained models.</li>
<li>How to prepare a face detection dataset including first extracting faces via a face detection system and then extracting face features via face embeddings.</li>
<li>How to fit, evaluate, and demonstrate an SVM model to predict identities from faces embeddings.</li>
</ul>
<p>Discover how to build models for photo classification, object detection, face recognition, and more <a href="https://machinelearningmastery.com/deep-learning-for-computer-vision/" rel="nofollow">in my new computer vision book</a>, with 30 step-by-step tutorials and full source code.</p>
<p>Let’s get started.</p>
<ul>
<li><b>Update Nov/2019:&nbsp;</b>Updated for TensorFlow v2.0 and MTCNN v0.1.0.</li>
</ul>
<div id="attachment_7827" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-7827" class="size-full wp-image-7827" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/How-to-Develop-a-Face-Recognition-System-Using-FaceNet-in-Keras-and-an-SVM-Classifier.jpg" alt="How to Develop a Face Recognition System Using FaceNet in Keras and an SVM Classifier" width="640" height="427" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/06/How-to-Develop-a-Face-Recognition-System-Using-FaceNet-in-Keras-and-an-SVM-Classifier.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/06/How-to-Develop-a-Face-Recognition-System-Using-FaceNet-in-Keras-and-an-SVM-Classifier-300x200.jpg 300w" sizes="(max-width: 640px) 100vw, 640px"><p id="caption-attachment-7827" class="wp-caption-text">How to Develop a Face Recognition System Using FaceNet in Keras and an SVM Classifier<br>Photo by <a href="https://www.flickr.com/photos/petervalverde/45786176624/">Peter Valverde</a>, some rights reserved.</p></div>
<h2>Tutorial Overview</h2>
<p>This tutorial is divided into five parts; they are:</p>
<ol>
<li>Face Recognition</li>
<li>FaceNet Model</li>
<li>How to Load a FaceNet Model in Keras</li>
<li>How to Detect Faces for Face Recognition</li>
<li>How to Develop a Face Classification System</li>
</ol>
<h2>Face Recognition</h2>
<p>Face recognition is the general task of identifying and verifying people from photographs of their face.</p>
<p>The 2011 book on face recognition titled “<a href="https://amzn.to/2EuR8Oo">Handbook of Face Recognition</a>” describes two main modes for face recognition, as:</p>
<ul>
<li><strong>Face Verification</strong>. A one-to-one mapping of a given face against a known identity (e.g. <em>is this the person?</em>).</li>
<li><strong>Face Identification</strong>. A one-to-many mapping for a given face against a database of known faces (e.g. <em>who is this person?</em>).</li>
</ul>
<blockquote><p>A face recognition system is expected to identify faces present in images and videos automatically. It can operate in either or both of two modes: (1) face verification (or authentication), and (2) face identification (or recognition).</p></blockquote>
<p>— Page 1, <a href="https://amzn.to/2EuR8Oo">Handbook of Face Recognition</a>. 2011.</p>
<p>We will focus on the face identification task in this tutorial.</p>
<div class="woo-sc-hr"></div>
<center>
<h3>Want Results with Deep Learning for Computer Vision?</h3>
<p>Take my free 7-day email crash course now (with sample code).</p>
<p>Click to sign-up and also get a free PDF Ebook version of the course.</p>
<p><a href="https://machinelearningmastery.lpages.co/leadbox/1458ca1e0972a2%3A164f8be4f346dc/4715926590455808/" target="_blank" style="background: rgb(255, 206, 10); color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.25) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.5) 0px 1px 3px inset, rgba(0, 0, 0, 0.5) 0px 1px 3px;" data-leadbox="https://machinelearningmastery.lpages.co/leadbox/1458ca1e0972a2%3A164f8be4f346dc/4715926590455808/" data-leadbox-id="1458ca1e0972a2:164f8be4f346dc">Download Your FREE Mini-Course</a><script data-leadbox="1458ca1e0972a2:164f8be4f346dc" data-url="https://machinelearningmastery.lpages.co/leadbox/1458ca1e0972a2%3A164f8be4f346dc/4715926590455808/" data-config="%7B%7D" type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/leadbox-1553357564.js"></script></p>
</center>
<div class="woo-sc-hr"></div>
<h2>FaceNet Model</h2>
<p>FaceNet is a face recognition system that was described by <a href="http://www.florian-schroff.de/">Florian Schroff</a>, et al. at Google in their 2015 paper titled “<a href="https://arxiv.org/abs/1503.03832">FaceNet: A Unified Embedding for Face Recognition and Clustering</a>.”</p>
<p>It is a system that, given a picture of a face, will extract high-quality features from the face and predict a 128 element vector representation these features, called a face embedding.</p>
<blockquote><p>FaceNet, that directly learns a mapping from face images to a compact Euclidean space where distances directly correspond to a measure of face similarity.</p></blockquote>
<p>— <a href="https://arxiv.org/abs/1503.03832">FaceNet: A Unified Embedding for Face Recognition and Clustering</a>, 2015.</p>
<p>The model is a deep convolutional neural network trained via a triplet loss function that encourages vectors for the same identity to become more similar (smaller distance), whereas vectors for different identities are expected to become less similar (larger distance). The focus on training a model to create embeddings directly (rather than extracting them from an intermediate layer of a model) was an important innovation in this work.</p>
<blockquote><p>Our method uses a deep convolutional network trained to directly optimize the embedding itself, rather than an intermediate bottleneck layer as in previous deep learning approaches.</p></blockquote>
<p>— <a href="https://arxiv.org/abs/1503.03832">FaceNet: A Unified Embedding for Face Recognition and Clustering</a>, 2015.</p>
<p>These face embeddings were then used as the basis for training classifier systems on standard face recognition benchmark datasets, achieving then-state-of-the-art results.</p>
<blockquote><p>Our system cuts the error rate in comparison to the best published result by 30% …</p></blockquote>
<p>— <a href="https://arxiv.org/abs/1503.03832">FaceNet: A Unified Embedding for Face Recognition and Clustering</a>, 2015.</p>
<p>The paper also explores other uses of the embeddings, such as clustering to group like-faces based on their extracted features.</p>
<p>It is a robust and effective face recognition system, and the general nature of the extracted face embeddings lends the approach to a range of applications.</p>
<h2>How to Load a FaceNet Model in Keras</h2>
<p>There are a number of projects that provide tools to train FaceNet-based models and make use of pre-trained models.</p>
<p>Perhaps the most prominent is called <a href="http://cmusatyalab.github.io/openface/">OpenFace</a> that provides FaceNet models built and trained using the PyTorch deep learning framework. There is a port of OpenFace to Keras, called <a href="https://github.com/iwantooxxoox/Keras-OpenFace">Keras OpenFace</a>, but at the time of writing, the models appear to require Python 2, which is quite limiting.</p>
<p>Another prominent project is called <a href="https://github.com/davidsandberg/facenet">FaceNet by David Sandberg</a> that provides FaceNet models built and trained using TensorFlow. The project looks mature, although at the time of writing does not provide a library-based installation nor clean API. Usefully, David’s project provides a number of high-performing pre-trained FaceNet models and there are a number of projects that port or convert these models for use in Keras.</p>
<p>A notable example is Keras <a href="https://github.com/nyoki-mtl/keras-facenet">FaceNet by Hiroki Taniai</a>. His project provides a script for converting the Inception ResNet v1 model from TensorFlow to Keras. He also provides a pre-trained Keras model ready for use.</p>
<p>We will use the pre-trained Keras FaceNet model provided by <a href="https://github.com/nyoki-mtl">Hiroki Taniai</a> in this tutorial. It was trained on <a href="https://www.microsoft.com/en-us/research/project/ms-celeb-1m-challenge-recognizing-one-million-celebrities-real-world/">MS-Celeb-1M dataset</a> and expects input images to be color, to have their pixel values whitened (standardized across all three channels), and to have a square shape of 160×160 pixels.</p>
<p>The model can be downloaded from here:</p>
<ul>
<li><a href="https://drive.google.com/open?id=1pwQ3H4aJ8a6yyJHZkTwtjcL4wYWQb7bn">Keras FaceNet Pre-Trained Model (88 megabytes)</a></li>
</ul>
<p>Download the model file and place it in your current working directory with the filename ‘<em>facenet_keras.h5</em>‘.</p>
<p>We can load the model directly in Keras using the <em>load_model()</em> function; for example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de38c095500040" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># example of loading the keras facenet model
from keras.models import load_model
# load the model
model = load_model('facenet_keras.h5')
# summarize input and output shape
print(model.inputs)
print(model.outputs)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de38c095500040-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de38c095500040-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de38c095500040-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de38c095500040-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de38c095500040-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de38c095500040-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de38c095500040-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de38c095500040-1"><span class="crayon-p"># example of loading the keras facenet model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de38c095500040-2"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-v">load_model</span></div><div class="crayon-line" id="crayon-5e0aca71de38c095500040-3"><span class="crayon-p"># load the model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de38c095500040-4"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'facenet_keras.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de38c095500040-5"><span class="crayon-p"># summarize input and output shape</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de38c095500040-6"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">inputs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de38c095500040-7"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">outputs</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Running the example loads the model and prints the shape of the input and output tensors.</p>
<p>We can see that the model indeed expects square color images as input with the shape 160×160, and will output a face embedding as a 128 element vector.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de392169176472" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># [&lt;tf.Tensor 'input_1:0' shape=(?, 160, 160, 3) dtype=float32&gt;]
# [&lt;tf.Tensor 'Bottleneck_BatchNorm/cond/Merge:0' shape=(?, 128) dtype=float32&gt;]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de392169176472-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de392169176472-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de392169176472-1"># [&lt;tf.Tensor 'input_1:0' shape=(?, 160, 160, 3) dtype=float32&gt;]</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de392169176472-2"># [&lt;tf.Tensor 'Bottleneck_BatchNorm/cond/Merge:0' shape=(?, 128) dtype=float32&gt;]</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Now that we have a FaceNet model, we can explore using it.</p>
<h2>How to Detect Faces for Face Recognition</h2>
<p>Before we can perform face recognition, we need to detect faces.</p>
<p><a href="https://machinelearningmastery.com/how-to-perform-face-detection-with-classical-and-deep-learning-methods-in-python-with-keras/">Face detection</a> is the process of automatically locating faces in a photograph and localizing them by drawing a bounding box around their extent.</p>
<p>In this tutorial, we will also use the Multi-Task Cascaded Convolutional Neural Network, or MTCNN, for face detection, e.g. finding and extracting faces from photos. This is a state-of-the-art deep learning model for face detection, described in the 2016 paper titled “<a href="https://arxiv.org/abs/1604.02878">Joint Face Detection and Alignment Using Multitask Cascaded Convolutional Networks</a>.”</p>
<p>We will use the implementation provided by <a href="https://www.linkedin.com/in/ivandepazcenteno/">Iván de Paz Centeno</a> in the <a href="https://github.com/ipazc/mtcnn">ipazc/mtcnn project</a>. This can also be installed via pip as follows:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de393533476162" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">sudo pip install mtcnn</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de393533476162-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de393533476162-1">sudo pip install mtcnn</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can confirm that the library was installed correctly by importing the library and printing the version; for example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de394546662437" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># confirm mtcnn was installed correctly
import mtcnn
# print version
print(mtcnn.__version__)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de394546662437-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de394546662437-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de394546662437-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de394546662437-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de394546662437-1"><span class="crayon-p"># confirm mtcnn was installed correctly</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de394546662437-2"><span class="crayon-e">import </span><span class="crayon-v">mtcnn</span></div><div class="crayon-line" id="crayon-5e0aca71de394546662437-3"><span class="crayon-p"># print version</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de394546662437-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">mtcnn</span><span class="crayon-sy">.</span><span class="crayon-v">__version__</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Running the example prints the current version of the library.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de395357217045" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">0.1.0</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de395357217045-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de395357217045-1">0.1.0</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can use the mtcnn library to create a face detector and extract faces for our use with the FaceNet face detector models in subsequent sections.</p>
<p>The first step is to load an image as a NumPy array, which we can achieve using the PIL library and the <em>open()</em> function. We will also convert the image to RGB, just in case the image has an alpha channel or is black and white.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de396663313944" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load image from file
image = Image.open(filename)
# convert to RGB, if needed
image = image.convert('RGB')
# convert to array
pixels = asarray(image)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de396663313944-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de396663313944-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de396663313944-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de396663313944-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de396663313944-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de396663313944-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de396663313944-1"><span class="crayon-p"># load image from file</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de396663313944-2"><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de396663313944-3"><span class="crayon-p"># convert to RGB, if needed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de396663313944-4"><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">convert</span><span class="crayon-sy">(</span><span class="crayon-s">'RGB'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de396663313944-5"><span class="crayon-p"># convert to array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de396663313944-6"><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Next, we can create an MTCNN face detector class and use it to detect all faces in the loaded photograph.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de397433570401" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># create the detector, using default weights
detector = MTCNN()
# detect faces in the image
results = detector.detect_faces(pixels)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de397433570401-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de397433570401-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de397433570401-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de397433570401-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de397433570401-1"><span class="crayon-p"># create the detector, using default weights</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de397433570401-2"><span class="crayon-v">detector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MTCNN</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de397433570401-3"><span class="crayon-p"># detect faces in the image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de397433570401-4"><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-e">detect_faces</span><span class="crayon-sy">(</span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The result is a list of bounding boxes, where each bounding box defines a lower-left-corner of the bounding box, as well as the width and height.</p>
<p>If we assume there is only one face in the photo for our experiments, we can determine the pixel coordinates of the bounding box as follows. Sometimes the library will return a negative pixel index, and I think this is a bug. We can fix this by taking the absolute value of the coordinates.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de398063810645" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># extract the bounding box from the first face
x1, y1, width, height = results[0]['box']
# bug fix
x1, y1 = abs(x1), abs(y1)
x2, y2 = x1 + width, y1 + height</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de398063810645-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de398063810645-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de398063810645-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de398063810645-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de398063810645-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de398063810645-1"><span class="crayon-p"># extract the bounding box from the first face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de398063810645-2"><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'box'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5e0aca71de398063810645-3"><span class="crayon-p"># bug fix</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de398063810645-4"><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">y1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de398063810645-5"><span class="crayon-v">x2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">height</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>We can use these coordinates to extract the face.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de399094577126" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># extract the face
face = pixels[y1:y2, x1:x2]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de399094577126-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de399094577126-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de399094577126-1"><span class="crayon-p"># extract the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de399094577126-2"><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">[</span><span class="crayon-v">y1</span><span class="crayon-o">:</span><span class="crayon-v">y2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-o">:</span><span class="crayon-v">x2</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can then use the PIL library to resize this small image of the face to the required size; specifically, the model expects square input faces with the shape 160×160.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de39a722884142" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># resize pixels to the model size
image = Image.fromarray(face)
image = image.resize((160, 160))
face_array = asarray(image)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de39a722884142-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39a722884142-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de39a722884142-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39a722884142-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de39a722884142-1"><span class="crayon-p"># resize pixels to the model size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39a722884142-2"><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">fromarray</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de39a722884142-3"><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">160</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">160</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39a722884142-4"><span class="crayon-v">face_array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Tying all of this together, the function <em>extract_face()</em> will load a photograph from the loaded filename and return the extracted face. It assumes that the photo contains one face and will return the first face detected.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de39b117937530" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># function for face detection with mtcnn
from PIL import Image
from numpy import asarray
from mtcnn.mtcnn import MTCNN

# extract a single face from a given photograph
def extract_face(filename, required_size=(160, 160)):
	# load image from file
	image = Image.open(filename)
	# convert to RGB, if needed
	image = image.convert('RGB')
	# convert to array
	pixels = asarray(image)
	# create the detector, using default weights
	detector = MTCNN()
	# detect faces in the image
	results = detector.detect_faces(pixels)
	# extract the bounding box from the first face
	x1, y1, width, height = results[0]['box']
	# bug fix
	x1, y1 = abs(x1), abs(y1)
	x2, y2 = x1 + width, y1 + height
	# extract the face
	face = pixels[y1:y2, x1:x2]
	# resize pixels to the model size
	image = Image.fromarray(face)
	image = image.resize(required_size)
	face_array = asarray(image)
	return face_array

# load the photo and extract the face
pixels = extract_face('...')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-12">12</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-14">14</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-16">16</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-18">18</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-20">20</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-22">22</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-24">24</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-26">26</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-28">28</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-30">30</div><div class="crayon-num" data-line="crayon-5e0aca71de39b117937530-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39b117937530-32">32</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de39b117937530-1"><span class="crayon-p"># function for face detection with mtcnn</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-2"><span class="crayon-e">from </span><span class="crayon-e">PIL </span><span class="crayon-e">import </span><span class="crayon-e">Image</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-4"><span class="crayon-e">from </span><span class="crayon-v">mtcnn</span><span class="crayon-sy">.</span><span class="crayon-e">mtcnn </span><span class="crayon-e">import </span><span class="crayon-v">MTCNN</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-6"><span class="crayon-p"># extract a single face from a given photograph</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-7"><span class="crayon-e">def </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">160</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">160</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-8"><span class="crayon-h">	</span><span class="crayon-p"># load image from file</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-9"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-10"><span class="crayon-h">	</span><span class="crayon-p"># convert to RGB, if needed</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-11"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">convert</span><span class="crayon-sy">(</span><span class="crayon-s">'RGB'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-12"><span class="crayon-h">	</span><span class="crayon-p"># convert to array</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-13"><span class="crayon-h">	</span><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-14"><span class="crayon-h">	</span><span class="crayon-p"># create the detector, using default weights</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-15"><span class="crayon-h">	</span><span class="crayon-v">detector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MTCNN</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-16"><span class="crayon-h">	</span><span class="crayon-p"># detect faces in the image</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-17"><span class="crayon-h">	</span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-e">detect_faces</span><span class="crayon-sy">(</span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-18"><span class="crayon-h">	</span><span class="crayon-p"># extract the bounding box from the first face</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-19"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'box'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-20"><span class="crayon-h">	</span><span class="crayon-p"># bug fix</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-21"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">y1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-22"><span class="crayon-h">	</span><span class="crayon-v">x2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">height</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-23"><span class="crayon-h">	</span><span class="crayon-p"># extract the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-24"><span class="crayon-h">	</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">[</span><span class="crayon-v">y1</span><span class="crayon-o">:</span><span class="crayon-v">y2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-o">:</span><span class="crayon-v">x2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-25"><span class="crayon-h">	</span><span class="crayon-p"># resize pixels to the model size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-26"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">fromarray</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-27"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">required_size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-28"><span class="crayon-h">	</span><span class="crayon-v">face_array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-29"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">face_array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-30">&nbsp;</div><div class="crayon-line" id="crayon-5e0aca71de39b117937530-31"><span class="crayon-p"># load the photo and extract the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39b117937530-32"><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-s">'...'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>We can use this function to extract faces as needed in the next section that can be provided as input to the FaceNet model.</p>
<h2>How to Develop a Face Classification System</h2>
<p>In this section, we will develop a face detection system to predict the identity of a given face.</p>
<p>The model will be trained and tested using the ‘<em>5 Celebrity Faces Dataset</em>‘ that contains many photographs of five different celebrities.</p>
<p>We will use an MTCNN model for face detection, the FaceNet model will be used to create a face embedding for each detected face, then we will develop a <a href="https://machinelearningmastery.com/support-vector-machines-for-machine-learning/">Linear Support Vector Machine (SVM)</a> classifier model to predict the identity of a given face.</p>
<h3>5 Celebrity Faces Dataset</h3>
<p>The 5 Celebrity Faces Dataset is a small dataset that contains photographs of celebrities.</p>
<p>It includes photos of: <a href="https://en.wikipedia.org/wiki/Ben_Affleck">Ben Affleck</a>, <a href="https://en.wikipedia.org/wiki/Elton_John">Elton John</a>, <a href="https://en.wikipedia.org/wiki/Jerry_Seinfeld">Jerry Seinfeld</a>, <a href="https://en.wikipedia.org/wiki/Madonna_(entertainer)">Madonna</a>, and <a href="https://en.wikipedia.org/wiki/Mindy_Kaling">Mindy Kaling</a>.</p>
<p>The dataset was prepared and made available by <a href="https://www.linkedin.com/in/dansbecker/">Dan Becker</a> and provided for <a href="https://www.kaggle.com/dansbecker/5-celebrity-faces-dataset">free download on Kaggle</a>. Note, a Kaggle account is required to download the dataset.</p>
<ul>
<li><a href="https://www.kaggle.com/dansbecker/5-celebrity-faces-dataset">5 Celebrity Faces Dataset, Kaggle</a>.</li>
</ul>
<p>Download the dataset (this may require a Kaggle login), data.zip (2.5 megabytes), and unzip it in your local directory with the folder name ‘<em>5-celebrity-faces-dataset</em>‘.</p>
<p>You should now have a directory with the following structure (note, there are spelling mistakes in some directory names, and they were left as-is in this example):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de39c343267052" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">5-celebrity-faces-dataset
├── train
│   ├── ben_afflek
│   ├── elton_john
│   ├── jerry_seinfeld
│   ├── madonna
│   └── mindy_kaling
└── val
    ├── ben_afflek
    ├── elton_john
    ├── jerry_seinfeld
    ├── madonna
    └── mindy_kaling</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de39c343267052-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39c343267052-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de39c343267052-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39c343267052-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de39c343267052-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39c343267052-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de39c343267052-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39c343267052-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de39c343267052-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39c343267052-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de39c343267052-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39c343267052-12">12</div><div class="crayon-num" data-line="crayon-5e0aca71de39c343267052-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de39c343267052-1">5-celebrity-faces-dataset</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39c343267052-2">├── train</div><div class="crayon-line" id="crayon-5e0aca71de39c343267052-3">│&nbsp;&nbsp; ├── ben_afflek</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39c343267052-4">│&nbsp;&nbsp; ├── elton_john</div><div class="crayon-line" id="crayon-5e0aca71de39c343267052-5">│&nbsp;&nbsp; ├── jerry_seinfeld</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39c343267052-6">│&nbsp;&nbsp; ├── madonna</div><div class="crayon-line" id="crayon-5e0aca71de39c343267052-7">│&nbsp;&nbsp; └── mindy_kaling</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39c343267052-8">└── val</div><div class="crayon-line" id="crayon-5e0aca71de39c343267052-9">&nbsp;&nbsp;&nbsp;&nbsp;├── ben_afflek</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39c343267052-10">&nbsp;&nbsp;&nbsp;&nbsp;├── elton_john</div><div class="crayon-line" id="crayon-5e0aca71de39c343267052-11">&nbsp;&nbsp;&nbsp;&nbsp;├── jerry_seinfeld</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39c343267052-12">&nbsp;&nbsp;&nbsp;&nbsp;├── madonna</div><div class="crayon-line" id="crayon-5e0aca71de39c343267052-13">&nbsp;&nbsp;&nbsp;&nbsp;└── mindy_kaling</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can see that there is a training dataset and a validation or test dataset.</p>
<p>Looking at some of the photos in the directories, we can see that the photos provide faces with a range of orientations, lighting, and in various sizes. Importantly, each photo contains one face of the person.</p>
<p>We will use this dataset as the basis for our classifier, trained on the ‘<em>train</em>‘ dataset only and classify faces in the ‘<em>val</em>‘ dataset. You can use this same structure to develop a classifier with your own photographs.</p>
<h3>Detect Faces</h3>
<p>The first step is to detect the face in each photograph and reduce the dataset to a series of faces only.</p>
<p>Let’s test out our face detector function defined in the previous section, specifically <em>extract_face()</em>.</p>
<p>Looking in the ‘<em>5-celebrity-faces-dataset/train/ben_afflek/</em>‘ directory, we can see that there are 14 photographs of Ben Affleck in the training dataset. We can detect the face in each photograph, and create a plot with 14 faces, with two rows of seven images each.</p>
<p>The complete example is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de39d014612750" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># demonstrate face detection on 5 Celebrity Faces Dataset
from os import listdir
from PIL import Image
from numpy import asarray
from matplotlib import pyplot
from mtcnn.mtcnn import MTCNN

# extract a single face from a given photograph
def extract_face(filename, required_size=(160, 160)):
	# load image from file
	image = Image.open(filename)
	# convert to RGB, if needed
	image = image.convert('RGB')
	# convert to array
	pixels = asarray(image)
	# create the detector, using default weights
	detector = MTCNN()
	# detect faces in the image
	results = detector.detect_faces(pixels)
	# extract the bounding box from the first face
	x1, y1, width, height = results[0]['box']
	# bug fix
	x1, y1 = abs(x1), abs(y1)
	x2, y2 = x1 + width, y1 + height
	# extract the face
	face = pixels[y1:y2, x1:x2]
	# resize pixels to the model size
	image = Image.fromarray(face)
	image = image.resize(required_size)
	face_array = asarray(image)
	return face_array

# specify folder to plot
folder = '5-celebrity-faces-dataset/train/ben_afflek/'
i = 1
# enumerate files
for filename in listdir(folder):
	# path
	path = folder + filename
	# get face
	face = extract_face(path)
	print(i, face.shape)
	# plot
	pyplot.subplot(2, 7, i)
	pyplot.axis('off')
	pyplot.imshow(face)
	i += 1
pyplot.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-12">12</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-14">14</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-16">16</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-18">18</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-20">20</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-22">22</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-24">24</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-26">26</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-28">28</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-30">30</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-32">32</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-34">34</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-36">36</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-38">38</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-40">40</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-42">42</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-44">44</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-46">46</div><div class="crayon-num" data-line="crayon-5e0aca71de39d014612750-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39d014612750-48">48</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de39d014612750-1"><span class="crayon-p"># demonstrate face detection on 5 Celebrity Faces Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-3"><span class="crayon-e">from </span><span class="crayon-e">PIL </span><span class="crayon-e">import </span><span class="crayon-e">Image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-6"><span class="crayon-e">from </span><span class="crayon-v">mtcnn</span><span class="crayon-sy">.</span><span class="crayon-e">mtcnn </span><span class="crayon-e">import </span><span class="crayon-v">MTCNN</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-8"><span class="crayon-p"># extract a single face from a given photograph</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-9"><span class="crayon-e">def </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">160</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">160</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-10"><span class="crayon-h">	</span><span class="crayon-p"># load image from file</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-11"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-12"><span class="crayon-h">	</span><span class="crayon-p"># convert to RGB, if needed</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-13"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">convert</span><span class="crayon-sy">(</span><span class="crayon-s">'RGB'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-14"><span class="crayon-h">	</span><span class="crayon-p"># convert to array</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-15"><span class="crayon-h">	</span><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-16"><span class="crayon-h">	</span><span class="crayon-p"># create the detector, using default weights</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-17"><span class="crayon-h">	</span><span class="crayon-v">detector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MTCNN</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-18"><span class="crayon-h">	</span><span class="crayon-p"># detect faces in the image</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-19"><span class="crayon-h">	</span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-e">detect_faces</span><span class="crayon-sy">(</span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-20"><span class="crayon-h">	</span><span class="crayon-p"># extract the bounding box from the first face</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-21"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'box'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-22"><span class="crayon-h">	</span><span class="crayon-p"># bug fix</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-23"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">y1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-24"><span class="crayon-h">	</span><span class="crayon-v">x2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">height</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-25"><span class="crayon-h">	</span><span class="crayon-p"># extract the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-26"><span class="crayon-h">	</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">[</span><span class="crayon-v">y1</span><span class="crayon-o">:</span><span class="crayon-v">y2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-o">:</span><span class="crayon-v">x2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-27"><span class="crayon-h">	</span><span class="crayon-p"># resize pixels to the model size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-28"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">fromarray</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-29"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">required_size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-30"><span class="crayon-h">	</span><span class="crayon-v">face_array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-31"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">face_array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-32">&nbsp;</div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-33"><span class="crayon-p"># specify folder to plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-34"><span class="crayon-v">folder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'5-celebrity-faces-dataset/train/ben_afflek/'</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-35"><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-36"><span class="crayon-p"># enumerate files</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-37"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">folder</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-38"><span class="crayon-h">	</span><span class="crayon-p"># path</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-39"><span class="crayon-h">	</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">folder</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-40"><span class="crayon-h">	</span><span class="crayon-p"># get face</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-41"><span class="crayon-h">	</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-42"><span class="crayon-h">	</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">face</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-43"><span class="crayon-h">	</span><span class="crayon-p"># plot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-44"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">subplot</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-45"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-46"><span class="crayon-h">	</span><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de39d014612750-47"><span class="crayon-h">	</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39d014612750-48"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Running the example takes a moment and reports the progress of each loaded photograph along the way and the shape of the NumPy array containing the face pixel data.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de39e258658636" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">1 (160, 160, 3)
2 (160, 160, 3)
3 (160, 160, 3)
4 (160, 160, 3)
5 (160, 160, 3)
6 (160, 160, 3)
7 (160, 160, 3)
8 (160, 160, 3)
9 (160, 160, 3)
10 (160, 160, 3)
11 (160, 160, 3)
12 (160, 160, 3)
13 (160, 160, 3)
14 (160, 160, 3)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de39e258658636-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39e258658636-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de39e258658636-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39e258658636-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de39e258658636-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39e258658636-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de39e258658636-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39e258658636-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de39e258658636-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39e258658636-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de39e258658636-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39e258658636-12">12</div><div class="crayon-num" data-line="crayon-5e0aca71de39e258658636-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39e258658636-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de39e258658636-1">1 (160, 160, 3)</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39e258658636-2">2 (160, 160, 3)</div><div class="crayon-line" id="crayon-5e0aca71de39e258658636-3">3 (160, 160, 3)</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39e258658636-4">4 (160, 160, 3)</div><div class="crayon-line" id="crayon-5e0aca71de39e258658636-5">5 (160, 160, 3)</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39e258658636-6">6 (160, 160, 3)</div><div class="crayon-line" id="crayon-5e0aca71de39e258658636-7">7 (160, 160, 3)</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39e258658636-8">8 (160, 160, 3)</div><div class="crayon-line" id="crayon-5e0aca71de39e258658636-9">9 (160, 160, 3)</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39e258658636-10">10 (160, 160, 3)</div><div class="crayon-line" id="crayon-5e0aca71de39e258658636-11">11 (160, 160, 3)</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39e258658636-12">12 (160, 160, 3)</div><div class="crayon-line" id="crayon-5e0aca71de39e258658636-13">13 (160, 160, 3)</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39e258658636-14">14 (160, 160, 3)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>A figure is created containing the faces detected in the Ben Affleck directory.</p>
<p>We can see that each face was correctly detected and that we have a range of lighting, skin tones, and orientations in the detected faces.</p>
<div id="attachment_7825" style="width: 1034px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-7825" class="size-large wp-image-7825" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/Plot-of-14-Faces-of-Ben-Afflek-Detected-from-the-Training-Dataset-of-the-5-Celebrity-Faces-Dataset-1024x768.png" alt="Plot of 14 Faces of Ben Affleck Detected From the Training Dataset of the 5 Celebrity Faces Dataset" width="1024" height="768" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Plot-of-14-Faces-of-Ben-Afflek-Detected-from-the-Training-Dataset-of-the-5-Celebrity-Faces-Dataset-1024x768.png 1024w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Plot-of-14-Faces-of-Ben-Afflek-Detected-from-the-Training-Dataset-of-the-5-Celebrity-Faces-Dataset-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Plot-of-14-Faces-of-Ben-Afflek-Detected-from-the-Training-Dataset-of-the-5-Celebrity-Faces-Dataset-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Plot-of-14-Faces-of-Ben-Afflek-Detected-from-the-Training-Dataset-of-the-5-Celebrity-Faces-Dataset.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"><p id="caption-attachment-7825" class="wp-caption-text">Plot of 14 Faces of Ben Affleck Detected From the Training Dataset of the 5 Celebrity Faces Dataset</p></div>
<p>So far, so good.</p>
<p>Next, we can extend this example to step over each subdirectory for a given dataset (e.g. ‘<em>train</em>‘ or ‘<em>val</em>‘), extract the faces, and prepare a dataset with the name as the output label for each detected face.</p>
<p>The <em>load_faces()</em> function below will load all of the faces into a list for a given directory, e.g. ‘<em>5-celebrity-faces-dataset/train/ben_afflek/</em>‘.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de39f562955783" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load images and extract faces for all images in a directory
def load_faces(directory):
	faces = list()
	# enumerate files
	for filename in listdir(directory):
		# path
		path = directory + filename
		# get face
		face = extract_face(path)
		# store
		faces.append(face)
	return faces</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de39f562955783-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39f562955783-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de39f562955783-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39f562955783-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de39f562955783-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39f562955783-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de39f562955783-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39f562955783-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de39f562955783-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39f562955783-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de39f562955783-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de39f562955783-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de39f562955783-1"><span class="crayon-p"># load images and extract faces for all images in a directory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39f562955783-2"><span class="crayon-e">def </span><span class="crayon-e">load_faces</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5e0aca71de39f562955783-3"><span class="crayon-h">	</span><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39f562955783-4"><span class="crayon-h">	</span><span class="crayon-p"># enumerate files</span></div><div class="crayon-line" id="crayon-5e0aca71de39f562955783-5"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39f562955783-6"><span class="crayon-h">		</span><span class="crayon-p"># path</span></div><div class="crayon-line" id="crayon-5e0aca71de39f562955783-7"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39f562955783-8"><span class="crayon-h">		</span><span class="crayon-p"># get face</span></div><div class="crayon-line" id="crayon-5e0aca71de39f562955783-9"><span class="crayon-h">		</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39f562955783-10"><span class="crayon-h">		</span><span class="crayon-p"># store</span></div><div class="crayon-line" id="crayon-5e0aca71de39f562955783-11"><span class="crayon-h">		</span><span class="crayon-v">faces</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de39f562955783-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">faces</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>We can call the <em>load_faces()</em> function for each subdirectory in the ‘<em>train</em>‘ or ‘<em>val</em>‘ folders. Each face has one label, the name of the celebrity, which we can take from the directory name.</p>
<p>The <em>load_dataset()</em> function below takes a directory name such as ‘<em>5-celebrity-faces-dataset/train/</em>‘ and detects faces for each subdirectory (celebrity), assigning labels to each detected face.</p>
<p>It returns the <em>X</em> and <em>y</em> elements of the dataset as NumPy arrays.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3a1298708824" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load a dataset that contains one subdir for each class that in turn contains images
def load_dataset(directory):
	X, y = list(), list()
	# enumerate folders, on per class
	for subdir in listdir(directory):
		# path
		path = directory + subdir + '/'
		# skip any files that might be in the dir
		if not isdir(path):
			continue
		# load all faces in the subdirectory
		faces = load_faces(path)
		# create labels
		labels = [subdir for _ in range(len(faces))]
		# summarize progress
		print('&gt;loaded %d examples for class: %s' % (len(faces), subdir))
		# store
		X.extend(faces)
		y.extend(labels)
	return asarray(X), asarray(y)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3a1298708824-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a1298708824-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3a1298708824-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a1298708824-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3a1298708824-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a1298708824-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de3a1298708824-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a1298708824-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de3a1298708824-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a1298708824-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de3a1298708824-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a1298708824-12">12</div><div class="crayon-num" data-line="crayon-5e0aca71de3a1298708824-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a1298708824-14">14</div><div class="crayon-num" data-line="crayon-5e0aca71de3a1298708824-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a1298708824-16">16</div><div class="crayon-num" data-line="crayon-5e0aca71de3a1298708824-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a1298708824-18">18</div><div class="crayon-num" data-line="crayon-5e0aca71de3a1298708824-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a1298708824-20">20</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3a1298708824-1"><span class="crayon-p"># load a dataset that contains one subdir for each class that in turn contains images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a1298708824-2"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5e0aca71de3a1298708824-3"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a1298708824-4"><span class="crayon-h">	</span><span class="crayon-p"># enumerate folders, on per class</span></div><div class="crayon-line" id="crayon-5e0aca71de3a1298708824-5"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">subdir </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a1298708824-6"><span class="crayon-h">		</span><span class="crayon-p"># path</span></div><div class="crayon-line" id="crayon-5e0aca71de3a1298708824-7"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">subdir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a1298708824-8"><span class="crayon-h">		</span><span class="crayon-p"># skip any files that might be in the dir</span></div><div class="crayon-line" id="crayon-5e0aca71de3a1298708824-9"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">isdir</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a1298708824-10"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line" id="crayon-5e0aca71de3a1298708824-11"><span class="crayon-h">		</span><span class="crayon-p"># load all faces in the subdirectory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a1298708824-12"><span class="crayon-h">		</span><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_faces</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a1298708824-13"><span class="crayon-h">		</span><span class="crayon-p"># create labels</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a1298708824-14"><span class="crayon-h">		</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">subdir </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5e0aca71de3a1298708824-15"><span class="crayon-h">		</span><span class="crayon-p"># summarize progress</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a1298708824-16"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;loaded %d examples for class: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">subdir</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a1298708824-17"><span class="crayon-h">		</span><span class="crayon-p"># store</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a1298708824-18"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">extend</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a1298708824-19"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">extend</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a1298708824-20"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>We can then call this function for the ‘train’ and ‘val’ folders to load all of the data, then save the results in a single compressed NumPy array file via the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.savez_compressed.html">savez_compressed() function</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3a2396508163" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load train dataset
trainX, trainy = load_dataset('5-celebrity-faces-dataset/train/')
print(trainX.shape, trainy.shape)
# load test dataset
testX, testy = load_dataset('5-celebrity-faces-dataset/val/')
print(testX.shape, testy.shape)
# save arrays to one file in compressed format
savez_compressed('5-celebrity-faces-dataset.npz', trainX, trainy, testX, testy)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3a2396508163-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a2396508163-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3a2396508163-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a2396508163-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3a2396508163-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a2396508163-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de3a2396508163-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a2396508163-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3a2396508163-1"><span class="crayon-p"># load train dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a2396508163-2"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-dataset/train/'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a2396508163-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a2396508163-4"><span class="crayon-p"># load test dataset</span></div><div class="crayon-line" id="crayon-5e0aca71de3a2396508163-5"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-dataset/val/'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a2396508163-6"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a2396508163-7"><span class="crayon-p"># save arrays to one file in compressed format</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a2396508163-8"><span class="crayon-e">savez_compressed</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-dataset.npz'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Tying all of this together, the complete example of detecting all of the faces in the 5 Celebrity Faces Dataset is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3a3064046153" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button crayon-pressed" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 1; opacity: 1; overflow: hidden; height: 1125px;"># face detection for the 5 Celebrity Faces Dataset
from os import listdir
from os.path import isdir
from PIL import Image
from matplotlib import pyplot
from numpy import savez_compressed
from numpy import asarray
from mtcnn.mtcnn import MTCNN

# extract a single face from a given photograph
def extract_face(filename, required_size=(160, 160)):
	# load image from file
	image = Image.open(filename)
	# convert to RGB, if needed
	image = image.convert('RGB')
	# convert to array
	pixels = asarray(image)
	# create the detector, using default weights
	detector = MTCNN()
	# detect faces in the image
	results = detector.detect_faces(pixels)
	# extract the bounding box from the first face
	x1, y1, width, height = results[0]['box']
	# bug fix
	x1, y1 = abs(x1), abs(y1)
	x2, y2 = x1 + width, y1 + height
	# extract the face
	face = pixels[y1:y2, x1:x2]
	# resize pixels to the model size
	image = Image.fromarray(face)
	image = image.resize(required_size)
	face_array = asarray(image)
	return face_array

# load images and extract faces for all images in a directory
def load_faces(directory):
	faces = list()
	# enumerate files
	for filename in listdir(directory):
		# path
		path = directory + filename
		# get face
		face = extract_face(path)
		# store
		faces.append(face)
	return faces

# load a dataset that contains one subdir for each class that in turn contains images
def load_dataset(directory):
	X, y = list(), list()
	# enumerate folders, on per class
	for subdir in listdir(directory):
		# path
		path = directory + subdir + '/'
		# skip any files that might be in the dir
		if not isdir(path):
			continue
		# load all faces in the subdirectory
		faces = load_faces(path)
		# create labels
		labels = [subdir for _ in range(len(faces))]
		# summarize progress
		print('&gt;loaded %d examples for class: %s' % (len(faces), subdir))
		# store
		X.extend(faces)
		y.extend(labels)
	return asarray(X), asarray(y)

# load train dataset
trainX, trainy = load_dataset('5-celebrity-faces-dataset/train/')
print(trainX.shape, trainy.shape)
# load test dataset
testX, testy = load_dataset('5-celebrity-faces-dataset/val/')
# save arrays to one file in compressed format
savez_compressed('5-celebrity-faces-dataset.npz', trainX, trainy, testX, testy)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 0; overflow: hidden; opacity: 0;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-12">12</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-14">14</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-16">16</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-18">18</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-20">20</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-22">22</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-24">24</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-26">26</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-28">28</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-30">30</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-32">32</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-34">34</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-36">36</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-38">38</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-40">40</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-42">42</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-44">44</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-46">46</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-48">48</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-50">50</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-52">52</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-54">54</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-56">56</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-58">58</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-60">60</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-62">62</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-64">64</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-66">66</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-68">68</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-70">70</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-72">72</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a3064046153-74">74</div><div class="crayon-num" data-line="crayon-5e0aca71de3a3064046153-75">75</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-1"><span class="crayon-p"># face detection for the 5 Celebrity Faces Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-2"><span class="crayon-e">from </span><span class="crayon-e">os </span><span class="crayon-e">import </span><span class="crayon-e">listdir</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-3"><span class="crayon-e">from </span><span class="crayon-v">os</span><span class="crayon-sy">.</span><span class="crayon-e">path </span><span class="crayon-e">import </span><span class="crayon-e">isdir</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-4"><span class="crayon-e">from </span><span class="crayon-e">PIL </span><span class="crayon-e">import </span><span class="crayon-e">Image</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-5"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-e">pyplot</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-6"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">savez_compressed</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-7"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-8"><span class="crayon-e">from </span><span class="crayon-v">mtcnn</span><span class="crayon-sy">.</span><span class="crayon-e">mtcnn </span><span class="crayon-e">import </span><span class="crayon-v">MTCNN</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-10"><span class="crayon-p"># extract a single face from a given photograph</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-11"><span class="crayon-e">def </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required_size</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">160</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">160</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-12"><span class="crayon-h">	</span><span class="crayon-p"># load image from file</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-13"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-14"><span class="crayon-h">	</span><span class="crayon-p"># convert to RGB, if needed</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-15"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">convert</span><span class="crayon-sy">(</span><span class="crayon-s">'RGB'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-16"><span class="crayon-h">	</span><span class="crayon-p"># convert to array</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-17"><span class="crayon-h">	</span><span class="crayon-v">pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-18"><span class="crayon-h">	</span><span class="crayon-p"># create the detector, using default weights</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-19"><span class="crayon-h">	</span><span class="crayon-v">detector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">MTCNN</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-20"><span class="crayon-h">	</span><span class="crayon-p"># detect faces in the image</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-21"><span class="crayon-h">	</span><span class="crayon-v">results</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-e">detect_faces</span><span class="crayon-sy">(</span><span class="crayon-v">pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-22"><span class="crayon-h">	</span><span class="crayon-p"># extract the bounding box from the first face</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-23"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">height</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">results</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-s">'box'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-24"><span class="crayon-h">	</span><span class="crayon-p"># bug fix</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-25"><span class="crayon-h">	</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">y1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-26"><span class="crayon-h">	</span><span class="crayon-v">x2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">height</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-27"><span class="crayon-h">	</span><span class="crayon-p"># extract the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-28"><span class="crayon-h">	</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pixels</span><span class="crayon-sy">[</span><span class="crayon-v">y1</span><span class="crayon-o">:</span><span class="crayon-v">y2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-o">:</span><span class="crayon-v">x2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-29"><span class="crayon-h">	</span><span class="crayon-p"># resize pixels to the model size</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-30"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Image</span><span class="crayon-sy">.</span><span class="crayon-e">fromarray</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-31"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">required_size</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-32"><span class="crayon-h">	</span><span class="crayon-v">face_array</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-33"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">face_array</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-34">&nbsp;</div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-35"><span class="crayon-p"># load images and extract faces for all images in a directory</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-36"><span class="crayon-e">def </span><span class="crayon-e">load_faces</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-37"><span class="crayon-h">	</span><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-38"><span class="crayon-h">	</span><span class="crayon-p"># enumerate files</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-39"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">filename </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-40"><span class="crayon-h">		</span><span class="crayon-p"># path</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-41"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">filename</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-42"><span class="crayon-h">		</span><span class="crayon-p"># get face</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-43"><span class="crayon-h">		</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">extract_face</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-44"><span class="crayon-h">		</span><span class="crayon-p"># store</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-45"><span class="crayon-h">		</span><span class="crayon-v">faces</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-46"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">faces</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-47">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-48"><span class="crayon-p"># load a dataset that contains one subdir for each class that in turn contains images</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-49"><span class="crayon-e">def </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-50"><span class="crayon-h">	</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-51"><span class="crayon-h">	</span><span class="crayon-p"># enumerate folders, on per class</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-52"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">subdir </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">listdir</span><span class="crayon-sy">(</span><span class="crayon-v">directory</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-53"><span class="crayon-h">		</span><span class="crayon-p"># path</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-54"><span class="crayon-h">		</span><span class="crayon-v">path</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">directory</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">subdir</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">'/'</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-55"><span class="crayon-h">		</span><span class="crayon-p"># skip any files that might be in the dir</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-56"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-e">isdir</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-57"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-58"><span class="crayon-h">		</span><span class="crayon-p"># load all faces in the subdirectory</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-59"><span class="crayon-h">		</span><span class="crayon-v">faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_faces</span><span class="crayon-sy">(</span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-60"><span class="crayon-h">		</span><span class="crayon-p"># create labels</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-61"><span class="crayon-h">		</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-e">subdir </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-62"><span class="crayon-h">		</span><span class="crayon-p"># summarize progress</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-63"><span class="crayon-h">		</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'&gt;loaded %d examples for class: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">len</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">subdir</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-64"><span class="crayon-h">		</span><span class="crayon-p"># store</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-65"><span class="crayon-h">		</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">extend</span><span class="crayon-sy">(</span><span class="crayon-v">faces</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-66"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">extend</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-67"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-68">&nbsp;</div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-69"><span class="crayon-p"># load train dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-70"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-dataset/train/'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-71"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-72"><span class="crayon-p"># load test dataset</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-73"><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_dataset</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-dataset/val/'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a3064046153-74"><span class="crayon-p"># save arrays to one file in compressed format</span></div><div class="crayon-line" id="crayon-5e0aca71de3a3064046153-75"><span class="crayon-e">savez_compressed</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-dataset.npz'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>Running the example may take a moment.</p>
<p>First, all of the photos in the ‘<em>train</em>‘ dataset are loaded, then faces are extracted, resulting in 93 samples with square face input and a class label string as output. Then the ‘<em>val</em>‘ dataset is loaded, providing 25 samples that can be used as a test dataset.</p>
<p>Both datasets are then saved to a compressed NumPy array file called ‘<em>5-celebrity-faces-dataset.npz</em>‘ that is about three megabytes and is stored in the current working directory.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3a4605618263" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt;loaded 14 examples for class: ben_afflek
&gt;loaded 19 examples for class: madonna
&gt;loaded 17 examples for class: elton_john
&gt;loaded 22 examples for class: mindy_kaling
&gt;loaded 21 examples for class: jerry_seinfeld
(93, 160, 160, 3) (93,)
&gt;loaded 5 examples for class: ben_afflek
&gt;loaded 5 examples for class: madonna
&gt;loaded 5 examples for class: elton_john
&gt;loaded 5 examples for class: mindy_kaling
&gt;loaded 5 examples for class: jerry_seinfeld
(25, 160, 160, 3) (25,)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3a4605618263-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a4605618263-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3a4605618263-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a4605618263-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3a4605618263-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a4605618263-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de3a4605618263-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a4605618263-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de3a4605618263-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a4605618263-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de3a4605618263-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a4605618263-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3a4605618263-1">&gt;loaded 14 examples for class: ben_afflek</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a4605618263-2">&gt;loaded 19 examples for class: madonna</div><div class="crayon-line" id="crayon-5e0aca71de3a4605618263-3">&gt;loaded 17 examples for class: elton_john</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a4605618263-4">&gt;loaded 22 examples for class: mindy_kaling</div><div class="crayon-line" id="crayon-5e0aca71de3a4605618263-5">&gt;loaded 21 examples for class: jerry_seinfeld</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a4605618263-6">(93, 160, 160, 3) (93,)</div><div class="crayon-line" id="crayon-5e0aca71de3a4605618263-7">&gt;loaded 5 examples for class: ben_afflek</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a4605618263-8">&gt;loaded 5 examples for class: madonna</div><div class="crayon-line" id="crayon-5e0aca71de3a4605618263-9">&gt;loaded 5 examples for class: elton_john</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a4605618263-10">&gt;loaded 5 examples for class: mindy_kaling</div><div class="crayon-line" id="crayon-5e0aca71de3a4605618263-11">&gt;loaded 5 examples for class: jerry_seinfeld</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a4605618263-12">(25, 160, 160, 3) (25,)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>This dataset is ready to be provided to a face detection model.</p>
<h3>Create Face Embeddings</h3>
<p>The next step is to create a face embedding.</p>
<p>A face embedding is a vector that represents the features extracted from the face. This can then be compared with the vectors generated for other faces. For example, another vector that is close (by some measure) may be the same person, whereas another vector that is far (by some measure) may be a different person.</p>
<p>The classifier model that we want to develop will take a face embedding as input and predict the identity of the face. The FaceNet model will generate this embedding for a given image of a face.</p>
<p>The FaceNet model can be used as part of the classifier itself, or we can use the FaceNet model to pre-process a face to create a face embedding that can be stored and used as input to our classifier model. This latter approach is preferred as the FaceNet model is both large and slow to create a face embedding.</p>
<p>We can, therefore, pre-compute the face embeddings for all faces in the train and test (formally ‘<em>val</em>‘) sets in our 5 Celebrity Faces Dataset.</p>
<p>First, we can load our detected faces dataset using the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.load.html">load() NumPy function</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3a5016515718" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load the face dataset
data = load('5-celebrity-faces-dataset.npz')
trainX, trainy, testX, testy = data['arr_0'], data['arr_1'], data['arr_2'], data['arr_3']
print('Loaded: ', trainX.shape, trainy.shape, testX.shape, testy.shape)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3a5016515718-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a5016515718-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3a5016515718-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a5016515718-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3a5016515718-1"><span class="crayon-p"># load the face dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a5016515718-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-dataset.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a5016515718-3"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_0'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_1'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_2'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_3'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a5016515718-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded: '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Next, we can load our FaceNet model ready for converting faces into face embeddings.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3a6028188564" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load the facenet model
model = load_model('facenet_keras.h5')
print('Loaded Model')</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3a6028188564-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a6028188564-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3a6028188564-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3a6028188564-1"><span class="crayon-p"># load the facenet model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a6028188564-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'facenet_keras.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a6028188564-3"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded Model'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can then enumerate each face in the train and test datasets to predict an embedding.</p>
<p>To predict an embedding, first the pixel values of the image need to be suitably prepared to meet the expectations of the FaceNet model. This specific implementation of the FaceNet model expects that the pixel values are standardized.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3a7181451585" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># scale pixel values
face_pixels = face_pixels.astype('float32')
# standardize pixel values across channels (global)
mean, std = face_pixels.mean(), face_pixels.std()
face_pixels = (face_pixels - mean) / std</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3a7181451585-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a7181451585-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3a7181451585-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a7181451585-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3a7181451585-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3a7181451585-1"><span class="crayon-p"># scale pixel values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a7181451585-2"><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a7181451585-3"><span class="crayon-p"># standardize pixel values across channels (global)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a7181451585-4"><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a7181451585-5"><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">std</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>In order to make a prediction for one example in Keras, we must expand the dimensions so that the face array is one sample.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3a8220573073" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># transform face into one sample
samples = expand_dims(face_pixels, axis=0)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3a8220573073-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a8220573073-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3a8220573073-1"><span class="crayon-p"># transform face into one sample</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a8220573073-2"><span class="crayon-v">samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">face_pixels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can then use the model to make a prediction and extract the embedding vector.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3a9844013532" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># make prediction to get embedding
yhat = model.predict(samples)
# get embedding
embedding = yhat[0]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3a9844013532-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a9844013532-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3a9844013532-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3a9844013532-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3a9844013532-1"><span class="crayon-p"># make prediction to get embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a9844013532-2"><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3a9844013532-3"><span class="crayon-p"># get embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3a9844013532-4"><span class="crayon-v">embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>The <em>get_embedding()</em> function defined below implements these behaviors and will return a face embedding given a single image of a face and the loaded FaceNet model.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3aa561213094" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># get the face embedding for one face
def get_embedding(model, face_pixels):
	# scale pixel values
	face_pixels = face_pixels.astype('float32')
	# standardize pixel values across channels (global)
	mean, std = face_pixels.mean(), face_pixels.std()
	face_pixels = (face_pixels - mean) / std
	# transform face into one sample
	samples = expand_dims(face_pixels, axis=0)
	# make prediction to get embedding
	yhat = model.predict(samples)
	return yhat[0]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3aa561213094-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3aa561213094-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3aa561213094-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3aa561213094-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3aa561213094-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3aa561213094-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de3aa561213094-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3aa561213094-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de3aa561213094-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3aa561213094-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de3aa561213094-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3aa561213094-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3aa561213094-1"><span class="crayon-p"># get the face embedding for one face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3aa561213094-2"><span class="crayon-e">def </span><span class="crayon-e">get_embedding</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5e0aca71de3aa561213094-3"><span class="crayon-h">	</span><span class="crayon-p"># scale pixel values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3aa561213094-4"><span class="crayon-h">	</span><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3aa561213094-5"><span class="crayon-h">	</span><span class="crayon-p"># standardize pixel values across channels (global)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3aa561213094-6"><span class="crayon-h">	</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3aa561213094-7"><span class="crayon-h">	</span><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">std</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3aa561213094-8"><span class="crayon-h">	</span><span class="crayon-p"># transform face into one sample</span></div><div class="crayon-line" id="crayon-5e0aca71de3aa561213094-9"><span class="crayon-h">	</span><span class="crayon-v">samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">face_pixels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3aa561213094-10"><span class="crayon-h">	</span><span class="crayon-p"># make prediction to get embedding</span></div><div class="crayon-line" id="crayon-5e0aca71de3aa561213094-11"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3aa561213094-12"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>Tying all of this together, the complete example of converting each face into a face embedding in the train and test datasets is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3ab661154193" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># calculate a face embedding for each face in the dataset using facenet
from numpy import load
from numpy import expand_dims
from numpy import asarray
from numpy import savez_compressed
from keras.models import load_model

# get the face embedding for one face
def get_embedding(model, face_pixels):
	# scale pixel values
	face_pixels = face_pixels.astype('float32')
	# standardize pixel values across channels (global)
	mean, std = face_pixels.mean(), face_pixels.std()
	face_pixels = (face_pixels - mean) / std
	# transform face into one sample
	samples = expand_dims(face_pixels, axis=0)
	# make prediction to get embedding
	yhat = model.predict(samples)
	return yhat[0]

# load the face dataset
data = load('5-celebrity-faces-dataset.npz')
trainX, trainy, testX, testy = data['arr_0'], data['arr_1'], data['arr_2'], data['arr_3']
print('Loaded: ', trainX.shape, trainy.shape, testX.shape, testy.shape)
# load the facenet model
model = load_model('facenet_keras.h5')
print('Loaded Model')
# convert each face in the train set to an embedding
newTrainX = list()
for face_pixels in trainX:
	embedding = get_embedding(model, face_pixels)
	newTrainX.append(embedding)
newTrainX = asarray(newTrainX)
print(newTrainX.shape)
# convert each face in the test set to an embedding
newTestX = list()
for face_pixels in testX:
	embedding = get_embedding(model, face_pixels)
	newTestX.append(embedding)
newTestX = asarray(newTestX)
print(newTestX.shape)
# save arrays to one file in compressed format
savez_compressed('5-celebrity-faces-embeddings.npz', newTrainX, trainy, newTestX, testy)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-12">12</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-14">14</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-16">16</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-18">18</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-20">20</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-22">22</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-24">24</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-26">26</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-28">28</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-30">30</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-32">32</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-34">34</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-36">36</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-38">38</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-40">40</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ab661154193-42">42</div><div class="crayon-num" data-line="crayon-5e0aca71de3ab661154193-43">43</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-1"><span class="crayon-p"># calculate a face embedding for each face in the dataset using facenet</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">load</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">expand_dims</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">asarray</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-5"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">savez_compressed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-v">load_model</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-8"><span class="crayon-p"># get the face embedding for one face</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-9"><span class="crayon-e">def </span><span class="crayon-e">get_embedding</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-10"><span class="crayon-h">	</span><span class="crayon-p"># scale pixel values</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-11"><span class="crayon-h">	</span><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'float32'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-12"><span class="crayon-h">	</span><span class="crayon-p"># standardize pixel values across channels (global)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-13"><span class="crayon-h">	</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-14"><span class="crayon-h">	</span><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">std</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-15"><span class="crayon-h">	</span><span class="crayon-p"># transform face into one sample</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-16"><span class="crayon-h">	</span><span class="crayon-v">samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">face_pixels</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-17"><span class="crayon-h">	</span><span class="crayon-p"># make prediction to get embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-18"><span class="crayon-h">	</span><span class="crayon-v">yhat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-19"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yhat</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-20">&nbsp;</div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-21"><span class="crayon-p"># load the face dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-22"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-dataset.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-23"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_0'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_1'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_2'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_3'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-24"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded: '</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-25"><span class="crayon-p"># load the facenet model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-26"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_model</span><span class="crayon-sy">(</span><span class="crayon-s">'facenet_keras.h5'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-27"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Loaded Model'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-28"><span class="crayon-p"># convert each face in the train set to an embedding</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-29"><span class="crayon-v">newTrainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-30"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">face_pixels </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">trainX</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-31"><span class="crayon-h">	</span><span class="crayon-v">embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_embedding</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-32"><span class="crayon-h">	</span><span class="crayon-v">newTrainX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">embedding</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-33"><span class="crayon-v">newTrainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">newTrainX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-34"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">newTrainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-35"><span class="crayon-p"># convert each face in the test set to an embedding</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-36"><span class="crayon-v">newTestX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-37"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">face_pixels </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-38"><span class="crayon-h">	</span><span class="crayon-v">embedding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_embedding</span><span class="crayon-sy">(</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">face_pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-39"><span class="crayon-h">	</span><span class="crayon-v">newTestX</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">embedding</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-40"><span class="crayon-v">newTestX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">newTestX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-41"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">newTestX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ab661154193-42"><span class="crayon-p"># save arrays to one file in compressed format</span></div><div class="crayon-line" id="crayon-5e0aca71de3ab661154193-43"><span class="crayon-e">savez_compressed</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-embeddings.npz'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">newTrainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">newTestX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>Running the example reports progress along the way.</p>
<p>We can see that the face dataset was loaded correctly and so was the model. The train dataset was then transformed into 93 face embeddings, each comprised of a 128 element vector. The 25 examples in the test dataset were also suitably converted to face embeddings.</p>
<p>The resulting datasets were then saved to a compressed NumPy array that is about 50 kilobytes with the name ‘<em>5-celebrity-faces-embeddings.npz</em>‘ in the current working directory.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3ac376407143" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Loaded:  (93, 160, 160, 3) (93,) (25, 160, 160, 3) (25,)
Loaded Model
(93, 128)
(25, 128)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3ac376407143-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ac376407143-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3ac376407143-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ac376407143-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3ac376407143-1">Loaded:&nbsp;&nbsp;(93, 160, 160, 3) (93,) (25, 160, 160, 3) (25,)</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ac376407143-2">Loaded Model</div><div class="crayon-line" id="crayon-5e0aca71de3ac376407143-3">(93, 128)</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ac376407143-4">(25, 128)</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We are now ready to develop our face classifier system.</p>
<h3>Perform Face Classification</h3>
<p>In this section, we will develop a model to classify face embeddings as one of the known celebrities in the 5 Celebrity Faces Dataset.</p>
<p>First, we must load the face embeddings dataset.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3ad941568783" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load dataset
data = load('5-celebrity-faces-embeddings.npz')
trainX, trainy, testX, testy = data['arr_0'], data['arr_1'], data['arr_2'], data['arr_3']
print('Dataset: train=%d, test=%d' % (trainX.shape[0], testX.shape[0]))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3ad941568783-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ad941568783-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3ad941568783-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ad941568783-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3ad941568783-1"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ad941568783-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-embeddings.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ad941568783-3"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_0'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_1'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_2'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_3'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ad941568783-4"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Dataset: train=%d, test=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Next, the data requires some minor preparation prior to modeling.</p>
<p>First, it is a good practice to normalize the face embedding vectors. It is a good practice because the vectors are often compared to each other using a distance metric.</p>
<p>In this context, <a href="https://machinelearningmastery.com/vector-norms-machine-learning/">vector normalization</a> means scaling the values until the length or magnitude of the vectors is 1 or unit length. This can be achieved using the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.Normalizer.html">Normalizer class in scikit-learn</a>. It might even be more convenient to perform this step when the face embeddings are created in the previous step.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3ae932605353" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># normalize input vectors
in_encoder = Normalizer(norm='l2')
trainX = in_encoder.transform(trainX)
testX = in_encoder.transform(testX)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3ae932605353-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ae932605353-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3ae932605353-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ae932605353-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3ae932605353-1"><span class="crayon-p"># normalize input vectors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ae932605353-2"><span class="crayon-v">in_encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Normalizer</span><span class="crayon-sy">(</span><span class="crayon-v">norm</span><span class="crayon-o">=</span><span class="crayon-s">'l2'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ae932605353-3"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ae932605353-4"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Next, the string target variables for each celebrity name need to be converted to integers.</p>
<p>This can be achieved via the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html">LabelEncoder class in scikit-learn</a>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3af354514235" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># label encode targets
out_encoder = LabelEncoder()
out_encoder.fit(trainy)
trainy = out_encoder.transform(trainy)
testy = out_encoder.transform(testy)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3af354514235-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3af354514235-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3af354514235-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3af354514235-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3af354514235-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3af354514235-1"><span class="crayon-p"># label encode targets</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3af354514235-2"><span class="crayon-v">out_encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3af354514235-3"><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3af354514235-4"><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3af354514235-5"><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">testy</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Next, we can fit a model.</p>
<p>It is common to use a <a href="https://machinelearningmastery.com/support-vector-machines-for-machine-learning/">Linear Support Vector Machine (SVM)</a> when working with normalized face embedding inputs. This is because the method is very effective at separating the face embedding vectors. We can fit a linear SVM to the training data using the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html">SVC class in scikit-learn</a> and setting the ‘<em>kernel</em>‘ attribute to ‘<em>linear</em>‘. We may also want probabilities later when making predictions, which can be configured by setting ‘<em>probability</em>‘ to ‘<em>True</em>‘.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3b0159673423" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># fit model
model = SVC(kernel='linear')
model.fit(trainX, trainy)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3b0159673423-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b0159673423-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3b0159673423-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3b0159673423-1"><span class="crayon-p"># fit model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b0159673423-2"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b0159673423-3"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Next, we can evaluate the model.</p>
<p>This can be achieved by using the fit model to make a prediction for each example in the train and test datasets and then calculating the classification accuracy.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3b1009438403" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># predict
yhat_train = model.predict(trainX)
yhat_test = model.predict(testX)
# score
score_train = accuracy_score(trainy, yhat_train)
score_test = accuracy_score(testy, yhat_test)
# summarize
print('Accuracy: train=%.3f, test=%.3f' % (score_train*100, score_test*100))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3b1009438403-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b1009438403-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3b1009438403-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b1009438403-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3b1009438403-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b1009438403-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de3b1009438403-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b1009438403-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3b1009438403-1"><span class="crayon-p"># predict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b1009438403-2"><span class="crayon-v">yhat_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b1009438403-3"><span class="crayon-v">yhat_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b1009438403-4"><span class="crayon-p"># score</span></div><div class="crayon-line" id="crayon-5e0aca71de3b1009438403-5"><span class="crayon-v">score_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">trainy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b1009438403-6"><span class="crayon-v">score_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">testy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b1009438403-7"><span class="crayon-p"># summarize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b1009438403-8"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: train=%.3f, test=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">score_train*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">score_test*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Tying all of this together, the complete example of fitting a Linear SVM on the face embeddings for the 5 Celebrity Faces Dataset is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3b2987014294" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># develop a classifier for the 5 Celebrity Faces Dataset
from numpy import load
from sklearn.metrics import accuracy_score
from sklearn.preprocessing import LabelEncoder
from sklearn.preprocessing import Normalizer
from sklearn.svm import SVC
# load dataset
data = load('5-celebrity-faces-embeddings.npz')
trainX, trainy, testX, testy = data['arr_0'], data['arr_1'], data['arr_2'], data['arr_3']
print('Dataset: train=%d, test=%d' % (trainX.shape[0], testX.shape[0]))
# normalize input vectors
in_encoder = Normalizer(norm='l2')
trainX = in_encoder.transform(trainX)
testX = in_encoder.transform(testX)
# label encode targets
out_encoder = LabelEncoder()
out_encoder.fit(trainy)
trainy = out_encoder.transform(trainy)
testy = out_encoder.transform(testy)
# fit model
model = SVC(kernel='linear', probability=True)
model.fit(trainX, trainy)
# predict
yhat_train = model.predict(trainX)
yhat_test = model.predict(testX)
# score
score_train = accuracy_score(trainy, yhat_train)
score_test = accuracy_score(testy, yhat_test)
# summarize
print('Accuracy: train=%.3f, test=%.3f' % (score_train*100, score_test*100))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-12">12</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-14">14</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-16">16</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-18">18</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-20">20</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-22">22</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-24">24</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-26">26</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-28">28</div><div class="crayon-num" data-line="crayon-5e0aca71de3b2987014294-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b2987014294-30">30</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-1"><span class="crayon-p"># develop a classifier for the 5 Celebrity Faces Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-2"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">load</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-e">import </span><span class="crayon-e">accuracy_score</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">LabelEncoder</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">Normalizer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-v">SVC</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-7"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-8"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-embeddings.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-9"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_0'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_1'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_2'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_3'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-10"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Dataset: train=%d, test=%d'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-11"><span class="crayon-p"># normalize input vectors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-12"><span class="crayon-v">in_encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Normalizer</span><span class="crayon-sy">(</span><span class="crayon-v">norm</span><span class="crayon-o">=</span><span class="crayon-s">'l2'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-13"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-14"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-15"><span class="crayon-p"># label encode targets</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-16"><span class="crayon-v">out_encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-17"><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-18"><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-19"><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">testy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-20"><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-21"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">probability</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-23"><span class="crayon-p"># predict</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-24"><span class="crayon-v">yhat_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-25"><span class="crayon-v">yhat_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-26"><span class="crayon-p"># score</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-27"><span class="crayon-v">score_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">trainy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-28"><span class="crayon-v">score_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">testy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yhat_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b2987014294-29"><span class="crayon-p"># summarize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b2987014294-30"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Accuracy: train=%.3f, test=%.3f'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e ">score_train*</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e ">score_test*</span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Running the example first confirms that the number of samples in the train and test datasets is as we expect</p>
<p>Next, the model is evaluated on the train and test dataset, showing perfect classification accuracy. This is not surprising given the size of the dataset and the power of the face detection and face recognition models used.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3b3590058527" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Dataset: train=93, test=25
Accuracy: train=100.000, test=100.000</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3b3590058527-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b3590058527-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3b3590058527-1">Dataset: train=93, test=25</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b3590058527-2">Accuracy: train=100.000, test=100.000</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>We can make it more interesting by plotting the original face and the prediction.</p>
<p>First, we need to load the face dataset, specifically the faces in the test dataset. We could also load the original photos to make it even more interesting.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3b4265077419" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load faces
data = load('5-celebrity-faces-dataset.npz')
testX_faces = data['arr_2']</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3b4265077419-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b4265077419-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3b4265077419-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3b4265077419-1"><span class="crayon-p"># load faces</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b4265077419-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-dataset.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b4265077419-3"><span class="crayon-v">testX_faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_2'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The rest of the example is the same up until we fit the model.</p>
<p>First, we need to select a random example from the test set, then get the embedding, face pixels, expected class prediction, and the corresponding name for the class.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3b5131908782" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># test model on a random example from the test dataset
selection = choice([i for i in range(testX.shape[0])])
random_face_pixels = testX_faces[selection]
random_face_emb = testX[selection]
random_face_class = testy[selection]
random_face_name = out_encoder.inverse_transform([random_face_class])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3b5131908782-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b5131908782-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3b5131908782-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b5131908782-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3b5131908782-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b5131908782-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3b5131908782-1"><span class="crayon-p"># test model on a random example from the test dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b5131908782-2"><span class="crayon-v">selection</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">choice</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b5131908782-3"><span class="crayon-v">random_face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX_faces</span><span class="crayon-sy">[</span><span class="crayon-v">selection</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b5131908782-4"><span class="crayon-v">random_face_emb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">[</span><span class="crayon-v">selection</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5e0aca71de3b5131908782-5"><span class="crayon-v">random_face_class</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">[</span><span class="crayon-v">selection</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b5131908782-6"><span class="crayon-v">random_face_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">random_face_class</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Next, we can use the face embedding as an input to make a single prediction with the fit model.</p>
<p>We can predict both the class integer and the probability of the prediction.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3b6155101183" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># prediction for the face
samples = expand_dims(random_face_emb, axis=0)
yhat_class = model.predict(samples)
yhat_prob = model.predict_proba(samples)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3b6155101183-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b6155101183-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3b6155101183-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b6155101183-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3b6155101183-1"><span class="crayon-p"># prediction for the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b6155101183-2"><span class="crayon-v">samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">random_face_emb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b6155101183-3"><span class="crayon-v">yhat_class</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b6155101183-4"><span class="crayon-v">yhat_prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict_proba</span><span class="crayon-sy">(</span><span class="crayon-v">samples</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>We can then get the name for the predicted class integer, and the probability for this prediction.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3b7198211311" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># get name
class_index = yhat_class[0]
class_probability = yhat_prob[0,class_index] * 100
predict_names = out_encoder.inverse_transform(yhat_class)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3b7198211311-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b7198211311-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3b7198211311-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b7198211311-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3b7198211311-1"><span class="crayon-p"># get name</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b7198211311-2"><span class="crayon-v">class_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">yhat_class</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5e0aca71de3b7198211311-3"><span class="crayon-v">class_probability</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">yhat_prob</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-v">class_index</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b7198211311-4"><span class="crayon-v">predict_names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">yhat_class</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>We can then print this information.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3b8028154995" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">print('Predicted: %s (%.3f)' % (predict_names[0], class_probability))
print('Expected: %s' % random_face_name[0])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3b8028154995-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b8028154995-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3b8028154995-1"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Predicted: %s (%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">predict_names</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_probability</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b8028154995-2"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Expected: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">random_face_name</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can also plot the face pixels along with the predicted name and probability.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3b9697828953" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># plot for fun
pyplot.imshow(random_face_pixels)
title = '%s (%.3f)' % (predict_names[0], class_probability)
pyplot.title(title)
pyplot.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3b9697828953-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b9697828953-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3b9697828953-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3b9697828953-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3b9697828953-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3b9697828953-1"><span class="crayon-p"># plot for fun</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b9697828953-2"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">random_face_pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b9697828953-3"><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'%s (%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">predict_names</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_probability</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3b9697828953-4"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-v">title</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3b9697828953-5"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>Tying all of this together, the complete example for predicting the identity for a given unseen photo in the test dataset is listed below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3ba440681822" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: 0px; display: block; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># develop a classifier for the 5 Celebrity Faces Dataset
from random import choice
from numpy import load
from numpy import expand_dims
from sklearn.preprocessing import LabelEncoder
from sklearn.preprocessing import Normalizer
from sklearn.svm import SVC
from matplotlib import pyplot
# load faces
data = load('5-celebrity-faces-dataset.npz')
testX_faces = data['arr_2']
# load face embeddings
data = load('5-celebrity-faces-embeddings.npz')
trainX, trainy, testX, testy = data['arr_0'], data['arr_1'], data['arr_2'], data['arr_3']
# normalize input vectors
in_encoder = Normalizer(norm='l2')
trainX = in_encoder.transform(trainX)
testX = in_encoder.transform(testX)
# label encode targets
out_encoder = LabelEncoder()
out_encoder.fit(trainy)
trainy = out_encoder.transform(trainy)
testy = out_encoder.transform(testy)
# fit model
model = SVC(kernel='linear', probability=True)
model.fit(trainX, trainy)
# test model on a random example from the test dataset
selection = choice([i for i in range(testX.shape[0])])
random_face_pixels = testX_faces[selection]
random_face_emb = testX[selection]
random_face_class = testy[selection]
random_face_name = out_encoder.inverse_transform([random_face_class])
# prediction for the face
samples = expand_dims(random_face_emb, axis=0)
yhat_class = model.predict(samples)
yhat_prob = model.predict_proba(samples)
# get name
class_index = yhat_class[0]
class_probability = yhat_prob[0,class_index] * 100
predict_names = out_encoder.inverse_transform(yhat_class)
print('Predicted: %s (%.3f)' % (predict_names[0], class_probability))
print('Expected: %s' % random_face_name[0])
# plot for fun
pyplot.imshow(random_face_pixels)
title = '%s (%.3f)' % (predict_names[0], class_probability)
pyplot.title(title)
pyplot.show()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-2">2</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-4">4</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-6">6</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-8">8</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-10">10</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-12">12</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-14">14</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-16">16</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-18">18</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-20">20</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-22">22</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-24">24</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-26">26</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-28">28</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-30">30</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-32">32</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-34">34</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-36">36</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-38">38</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-40">40</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-42">42</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-44">44</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3ba440681822-46">46</div><div class="crayon-num" data-line="crayon-5e0aca71de3ba440681822-47">47</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-1"><span class="crayon-p"># develop a classifier for the 5 Celebrity Faces Dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-2"><span class="crayon-e">from </span><span class="crayon-e">random </span><span class="crayon-e">import </span><span class="crayon-e">choice</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-3"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">load</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-4"><span class="crayon-e">from </span><span class="crayon-e">numpy </span><span class="crayon-e">import </span><span class="crayon-e">expand_dims</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-5"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">LabelEncoder</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-6"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-e">import </span><span class="crayon-e">Normalizer</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-7"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-e">import </span><span class="crayon-e">SVC</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-8"><span class="crayon-e">from </span><span class="crayon-e">matplotlib </span><span class="crayon-e">import </span><span class="crayon-v">pyplot</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-9"><span class="crayon-p"># load faces</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-10"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-dataset.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-11"><span class="crayon-v">testX_faces</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_2'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-12"><span class="crayon-p"># load face embeddings</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-13"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load</span><span class="crayon-sy">(</span><span class="crayon-s">'5-celebrity-faces-embeddings.npz'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-14"><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_0'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_1'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_2'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">'arr_3'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-15"><span class="crayon-p"># normalize input vectors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-16"><span class="crayon-v">in_encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Normalizer</span><span class="crayon-sy">(</span><span class="crayon-v">norm</span><span class="crayon-o">=</span><span class="crayon-s">'l2'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-17"><span class="crayon-v">trainX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-18"><span class="crayon-v">testX</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">in_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-19"><span class="crayon-p"># label encode targets</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-20"><span class="crayon-v">out_encoder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-21"><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-22"><span class="crayon-v">trainy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-23"><span class="crayon-v">testy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">testy</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-24"><span class="crayon-p"># fit model</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-25"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">probability</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-26"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">trainX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">trainy</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-27"><span class="crayon-p"># test model on a random example from the test dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-28"><span class="crayon-v">selection</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">choice</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-v">testX</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-29"><span class="crayon-v">random_face_pixels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX_faces</span><span class="crayon-sy">[</span><span class="crayon-v">selection</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-30"><span class="crayon-v">random_face_emb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testX</span><span class="crayon-sy">[</span><span class="crayon-v">selection</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-31"><span class="crayon-v">random_face_class</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">testy</span><span class="crayon-sy">[</span><span class="crayon-v">selection</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-32"><span class="crayon-v">random_face_name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">random_face_class</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-33"><span class="crayon-p"># prediction for the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-34"><span class="crayon-v">samples</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">random_face_emb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-35"><span class="crayon-v">yhat_class</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">samples</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-36"><span class="crayon-v">yhat_prob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict_proba</span><span class="crayon-sy">(</span><span class="crayon-v">samples</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-37"><span class="crayon-p"># get name</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-38"><span class="crayon-v">class_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">yhat_class</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-39"><span class="crayon-v">class_probability</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">yhat_prob</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-v">class_index</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-40"><span class="crayon-v">predict_names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">out_encoder</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">yhat_class</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-41"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Predicted: %s (%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">predict_names</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_probability</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-42"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Expected: %s'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">random_face_name</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-43"><span class="crayon-p"># plot for fun</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-44"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">random_face_pixels</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-45"><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'%s (%.3f)'</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">predict_names</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">class_probability</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3ba440681822-46"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-v">title</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5e0aca71de3ba440681822-47"><span class="crayon-v">pyplot</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>A different random example from the test dataset will be selected each time the code is run.</p>
<p>Try running it a few times.</p>
<p>In this case, a photo of Jerry Seinfeld is selected and correctly predicted.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71de3bb020441122" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">Predicted: jerry_seinfeld (88.476)
Expected: jerry_seinfeld</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71de3bb020441122-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5e0aca71de3bb020441122-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71de3bb020441122-1">Predicted: jerry_seinfeld (88.476)</div><div class="crayon-line crayon-striped-line" id="crayon-5e0aca71de3bb020441122-2">Expected: jerry_seinfeld</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>A plot of the chosen face is also created, showing the predicted name and probability in the image title.</p>
<div id="attachment_7826" style="width: 310px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-7826" class="wp-image-7826 size-medium" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier-300x225.png" alt="Detected Face of Jerry Seinfeld, Correctly Identified by the SVM Classifier" width="300" height="225" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier-300x225.png 300w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier-768x576.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier-1024x768.png 1024w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2019/03/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier.png 1280w" sizes="(max-width: 300px) 100vw, 300px"><p id="caption-attachment-7826" class="wp-caption-text">Detected Face of Jerry Seinfeld, Correctly Identified by the SVM Classifier</p></div>
<h2>Further Reading</h2>
<p>This section provides more resources on the topic if you are looking to go deeper.</p>
<h3>Papers</h3>
<ul>
<li><a href="https://arxiv.org/abs/1503.03832">FaceNet: A Unified Embedding for Face Recognition and Clustering</a>, 2015.</li>
</ul>
<h3>Books</h3>
<ul>
<li><a href="https://amzn.to/2EuR8Oo">Handbook of Face Recognition,</a>&nbsp;2011.</li>
</ul>
<h3>Projects</h3>
<ul>
<li><a href="http://cmusatyalab.github.io/openface/">OpenFace PyTorch Project</a>.</li>
<li><a href="https://github.com/iwantooxxoox/Keras-OpenFace">OpenFace Keras Project, GitHub</a>.</li>
<li><a href="https://github.com/nyoki-mtl/keras-facenet">Keras FaceNet Project, GitHub</a>.</li>
<li><a href="https://www.microsoft.com/en-us/research/project/ms-celeb-1m-challenge-recognizing-one-million-celebrities-real-world/">MS-Celeb 1M Dataset</a>.</li>
</ul>
<h3>APIs</h3>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.Normalizer.html">sklearn.preprocessing.Normalizer API</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html">sklearn.preprocessing.LabelEncoder API</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html">sklearn.svm.SVC API</a></li>
</ul>
<h2>Summary</h2>
<p>In this tutorial, you discovered how to develop a face detection system using FaceNet and an SVM classifier to identify people from photographs.</p>
<p>Specifically, you learned:</p>
<ul>
<li>About the FaceNet face recognition system developed by Google and open source implementations and pre-trained models.</li>
<li>How to prepare a face detection dataset including first extracting faces via a face detection system and then extracting face features via face embeddings.</li>
<li>How to fit, evaluate, and demonstrate an SVM model to predict identities from faces embeddings.</li>
</ul>
<p>Do you have any questions?<br>
Ask your questions in the comments below and I will do my best to answer.</p>
<div class="widget_text awac-wrapper"><div class="widget_text awac widget custom_html-65"><div class="textwidget custom-html-widget"><div style="text-align: center;">
<div class="woo-sc-hr"></div>
<h2>Develop Deep Learning Models for Vision Today!</h2>
<a href="https://machinelearningmastery.com/deep-learning-for-computer-vision/" rel="nofollow"><img style="border: 0;" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/Deep-Learning-for-Computer-Vision-220-1.png" alt="Deep Learning for Computer Vision" align="left"></a>
<h4>Develop Your Own Vision Models in Minutes</h4>
<p>...with just a few lines of python code</p>

<p>Discover how in my new Ebook:<br>
<a href="https://machinelearningmastery.com/deep-learning-for-computer-vision/" rel="nofollow">Deep Learning for Computer Vision</a></p>

<p>It provides <strong>self-study tutorials</strong> on topics like:<br>
	<em>classification</em>, <em>object detection (yolo and rcnn)</em>, <em>face recognition (vggface and facenet)</em>, <em>data preparation</em> and much more...</p>

<h4>Finally Bring Deep Learning to your Vision Projects</h4>
	<p>Skip the Academics. Just Results.</p>

<a href="https://machinelearningmastery.com/deep-learning-for-computer-vision/" class="woo-sc-button  custom" style="background:;border-color:"><span class="woo-">See What's Inside</span></a>

<div class="woo-sc-hr"></div>
</div></div></div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-7815 post  simplesocialbuttons-inline-no-animation">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Develop+a+Face+Recognition+System+Using+FaceNet+in+Keras&amp;url=https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/" onclick="javascript:window.open(this.dataset.href, &#39;&#39;, &#39;menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600&#39;);return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37.jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" height="80" width="80"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/how-to-perform-face-recognition-with-vggface2-convolutional-neural-network-in-keras/" rel="prev"><i class="fa fa-angle-left"></i> How to Perform Face Recognition With VGGFace2 in Keras</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/one-shot-learning-with-siamese-networks-contrastive-and-triplet-loss-for-face-recognition/" rel="next">One-Shot Learning for Face Recognition <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">173 Responses to <em>How to Develop a Face Recognition System Using FaceNet in Keras</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-488125" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-488125" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/a4e7ab81c95260f045e82d13c8bb9a9b.png" srcset="https://secure.gravatar.com/avatar/a4e7ab81c95260f045e82d13c8bb9a9b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abkul</span>
	                <span class="date">June 7, 2019 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-488125" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great tutorial. </p>
<p>Was looking at whether  Transfer learning,  Siamese network and triplet loss approaches are applicable to animal face(eg a sheep, goat etc)  recognition particularly mobileNet(or otherwise)  when your crystal clear blog came up. </p>
<p>Kindly shed more light on its applicability and any other auxiliary hints.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-488125" data-commentid="488125" data-postid="7815" data-belowelement="comment-488125" data-respondelement="respond" aria-label="Reply to Abkul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488146" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-488146" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 7, 2019 at 8:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-488146" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-488146" data-commentid="488146" data-postid="7815" data-belowelement="comment-488146" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-488176" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-488176" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/311258cab6522bc61cd68b638d8b9916.jpeg" srcset="https://secure.gravatar.com/avatar/311258cab6522bc61cd68b638d8b9916?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shravan Kumar</span>
	                <span class="date">June 7, 2019 at 3:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-488176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,  </p>
<p>This is fantastic, thanks for sharing.  </p>
<p>What do you suggest when we have tens of thousands of classes. </p>
<p>A Facenet model itself as a classifier or a specific classifier model is to be trained. In terms of scalability and performance which is the preferred method.</p>
<p>Referring to:<br>
“The FaceNet model can be used as part of the classifier itself, or we can use the FaceNet model to pre-process a face to create a face embedding that can be stored and used as input to our classifier model. This latter approach is preferred as the FaceNet model is both large and slow to create a face embedding.”</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-488176" data-commentid="488176" data-postid="7815" data-belowelement="comment-488176" data-respondelement="respond" aria-label="Reply to Shravan Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-488234" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-488234" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 8, 2019 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-488234" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, the facenet embedding approach is a good starting point, but perhaps check the literature for more scalable approaches.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-488234" data-commentid="488234" data-postid="7815" data-belowelement="comment-488234" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-489773" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-489773" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/4019e5608d3148f385bb593364d241f4.png" srcset="https://secure.gravatar.com/avatar/4019e5608d3148f385bb593364d241f4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anand</span>
	                <span class="date">June 21, 2019 at 11:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-489773" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi jason,<br>
      As per my understanding The triplet loss is used so that the model can also learn the dissimilarity between the classes rather than only learning similarity between same class.<br>
But here we are not training our model on the actual image dataset on which we need our classification to be done. Rather we are using SVM for that.<br>
            So, how can we make use of triplet loss in this method of face recognition?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-489773" data-commentid="489773" data-postid="7815" data-belowelement="comment-489773" data-respondelement="respond" aria-label="Reply to Anand">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-489830" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-489830" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 22, 2019 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-489830" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>See this post:<br>
<a href="https://machinelearningmastery.com/one-shot-learning-with-siamese-networks-contrastive-and-triplet-loss-for-face-recognition/" rel="nofollow ugc">https://machinelearningmastery.com/one-shot-learning-with-siamese-networks-contrastive-and-triplet-loss-for-face-recognition/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-489830" data-commentid="489830" data-postid="7815" data-belowelement="comment-489830" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-490115" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-490115" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/99b0712b3820205e2e3c853e2e518a7a.png" srcset="https://secure.gravatar.com/avatar/99b0712b3820205e2e3c853e2e518a7a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karan Sharma</span>
	                <span class="date">June 24, 2019 at 2:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490115" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I want to try this on Cat and Dog dataset. What do you thing the pre-trained networks face embeddings will work in this case?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490115" data-commentid="490115" data-postid="7815" data-belowelement="comment-490115" data-respondelement="respond" aria-label="Reply to Karan Sharma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490185" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-490185" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 25, 2019 at 6:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490185" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, I don’t think it will work for animals.</p>
<p>Interesting idea though.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490185" data-commentid="490185" data-postid="7815" data-belowelement="comment-490185" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490252" class="comment even depth-3 parent">

	      	<div id="li-comment-490252" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/99b0712b3820205e2e3c853e2e518a7a.png" srcset="https://secure.gravatar.com/avatar/99b0712b3820205e2e3c853e2e518a7a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karan Sharma</span>
	                <span class="date">June 25, 2019 at 2:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490252" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply. </p>
<p>What do you think how much effort will it take to train facenet from scratch?</p>
<p>And certainly how much data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490252" data-commentid="490252" data-postid="7815" data-belowelement="comment-490252" data-respondelement="respond" aria-label="Reply to Karan Sharma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490320" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-490320" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 26, 2019 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490320" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not off hand, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490320" data-commentid="490320" data-postid="7815" data-belowelement="comment-490320" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-490374" class="comment even thread-even depth-1">

	      	<div id="li-comment-490374" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/99b0712b3820205e2e3c853e2e518a7a.png" srcset="https://secure.gravatar.com/avatar/99b0712b3820205e2e3c853e2e518a7a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karan Sharma</span>
	                <span class="date">June 26, 2019 at 3:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490374" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the response Jason.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490374" data-commentid="490374" data-postid="7815" data-belowelement="comment-490374" data-respondelement="respond" aria-label="Reply to Karan Sharma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-490712" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-490712" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/99b0712b3820205e2e3c853e2e518a7a.png" srcset="https://secure.gravatar.com/avatar/99b0712b3820205e2e3c853e2e518a7a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karan Sharma</span>
	                <span class="date">June 28, 2019 at 4:27 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490712" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Can MTCNN detect faces of cats and dogs from image?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490712" data-commentid="490712" data-postid="7815" data-belowelement="comment-490712" data-respondelement="respond" aria-label="Reply to Karan Sharma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-490806" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-490806" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">June 29, 2019 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490806" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not, but the model would have to be trained on dogs and cats.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-490806" data-commentid="490806" data-postid="7815" data-belowelement="comment-490806" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-492131" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-492131" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/9a7614740f9e1fa6a2108622fc9222a6.png" srcset="https://secure.gravatar.com/avatar/9a7614740f9e1fa6a2108622fc9222a6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thinh</span>
	                <span class="date">July 8, 2019 at 5:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492131" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thanks for a very nice tutor. But i cant set up mtcnn in my python2? Is there a way to install mtcnn for python2?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492131" data-commentid="492131" data-postid="7815" data-belowelement="comment-492131" data-respondelement="respond" aria-label="Reply to Thinh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492202" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-492202" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 9, 2019 at 8:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492202" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t know, I have only used it with Python 3.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492202" data-commentid="492202" data-postid="7815" data-belowelement="comment-492202" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-492394" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-492394" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/9a7614740f9e1fa6a2108622fc9222a6.png" srcset="https://secure.gravatar.com/avatar/9a7614740f9e1fa6a2108622fc9222a6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thinh</span>
	                <span class="date">July 10, 2019 at 7:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492394" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. nice tutor!<br>
But i wonder that, if i want to identify who is stranger. should i make a folder for ‘stranger’ contains alot of stranger faces???(exclude your  5 Celebrity Faces Dataset ??)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492394" data-commentid="492394" data-postid="7815" data-belowelement="comment-492394" data-respondelement="respond" aria-label="Reply to Thinh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492440" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-492440" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2019 at 9:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492440" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question. </p>
<p>No, if a face does not match any known faces, it would be “unknown”. E.g. has a low probability for all known faces.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492440" data-commentid="492440" data-postid="7815" data-belowelement="comment-492440" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492462" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-492462" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/9a7614740f9e1fa6a2108622fc9222a6.png" srcset="https://secure.gravatar.com/avatar/9a7614740f9e1fa6a2108622fc9222a6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thinh</span>
	                <span class="date">July 11, 2019 at 12:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492462" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you very much. Keep writting tutorials to help thoudsands of thoudsands people like me a round the world learning ML,DL. &lt;3</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492462" data-commentid="492462" data-postid="7815" data-belowelement="comment-492462" data-respondelement="respond" aria-label="Reply to Thinh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492470" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-492470" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2019 at 1:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492470" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, I’m grateful for your support!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492470" data-commentid="492470" data-postid="7815" data-belowelement="comment-492470" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-492395" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-492395" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/9a7614740f9e1fa6a2108622fc9222a6.png" srcset="https://secure.gravatar.com/avatar/9a7614740f9e1fa6a2108622fc9222a6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thinh</span>
	                <span class="date">July 10, 2019 at 7:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>yeah! I figured out that MTCNN only require Python3.<br>
Follow this bellow: <a href="https://pypi.org/project/mtcnn/" rel="nofollow ugc">https://pypi.org/project/mtcnn/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492395" data-commentid="492395" data-postid="7815" data-belowelement="comment-492395" data-respondelement="respond" aria-label="Reply to Thinh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-492441" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-492441" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2019 at 9:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492441" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-492441" data-commentid="492441" data-postid="7815" data-belowelement="comment-492441" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-493081" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-493081" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/6a4b614a72d4aaf1a0cd8efd3ce3c1ae.png" srcset="https://secure.gravatar.com/avatar/6a4b614a72d4aaf1a0cd8efd3ce3c1ae?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nghia</span>
	                <span class="date">July 16, 2019 at 6:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493081" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your tutorial.<br>
But when i flollow you, i have a warning  :<br>
embeddings.npz is not UTF-8 encoded<br>
UserWarning: No training configuration found in save file: the model was *not* compiled. Compile it manually.<br>
Do you know how to fix it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493081" data-commentid="493081" data-postid="7815" data-belowelement="comment-493081" data-respondelement="respond" aria-label="Reply to Nghia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493143" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-493143" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 17, 2019 at 8:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493143" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can safely ignore these warnings.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493143" data-commentid="493143" data-postid="7815" data-belowelement="comment-493143" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493206" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-493206" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/6a4b614a72d4aaf1a0cd8efd3ce3c1ae.png" srcset="https://secure.gravatar.com/avatar/6a4b614a72d4aaf1a0cd8efd3ce3c1ae?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nghia</span>
	                <span class="date">July 17, 2019 at 6:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493206" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much.<br>
But when I have a new image to recognize, do I need to put it to the validate folder and rerun the code ?<br>
And how can we use this to recognite face in a video ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493206" data-commentid="493206" data-postid="7815" data-belowelement="comment-493206" data-respondelement="respond" aria-label="Reply to Nghia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493277" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-493277" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 18, 2019 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493277" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can use the model directly, e.g. in memory.</p>
<p>Perhaps you can process each frame of video as an image with the model?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493277" data-commentid="493277" data-postid="7815" data-belowelement="comment-493277" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-493662" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-493662" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/45170b362482a70554cfb180f3d2798b.png" srcset="https://secure.gravatar.com/avatar/45170b362482a70554cfb180f3d2798b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Karim</span>
	                <span class="date">July 21, 2019 at 8:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493662" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br>
Thanks for your wonderful tutorial, I’d like to know what is the best solution to apply recognition part if I have a very small dataset -only one face per each identity- in this case, I think SVM wouldn’t help.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493662" data-commentid="493662" data-postid="7815" data-belowelement="comment-493662" data-respondelement="respond" aria-label="Reply to Karim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-493714" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-493714" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 22, 2019 at 8:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493714" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think a model that uses a face embedding as an input would be a great starting point.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-493714" data-commentid="493714" data-postid="7815" data-belowelement="comment-493714" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494427" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-494427" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/648bc6e95b58010788a5bcf2f59afa64.png" srcset="https://secure.gravatar.com/avatar/648bc6e95b58010788a5bcf2f59afa64?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Esha</span>
	                <span class="date">July 27, 2019 at 10:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br>
           Thank you for this amazing tutorial, I used python 3 to run this code. I would like to know why am i getting this error (No module named ‘mtcnn’) and how can I correct it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494427" data-commentid="494427" data-postid="7815" data-belowelement="comment-494427" data-respondelement="respond" aria-label="Reply to Esha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494467" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-494467" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 28, 2019 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494467" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The error suggests you must install the mtcnn library:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5e0aca71e0c98304964118" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">pip install mtcnn</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5e0aca71e0c98304964118-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5e0aca71e0c98304964118-1"><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">mtcnn</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494467" data-commentid="494467" data-postid="7815" data-belowelement="comment-494467" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-494503" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-494503" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/4c9807d7fef52902fb1a0ac6f08b29d2.png" srcset="https://secure.gravatar.com/avatar/4c9807d7fef52902fb1a0ac6f08b29d2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sabbir</span>
	                <span class="date">July 28, 2019 at 4:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494503" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I want to use transfer learning for masked face recognition. But i didn’t found any better masked face recognition dataset. I need a masked face dataset with proper labeling of each candidate. So is there any better masked face dataset available? where can i find this dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494503" data-commentid="494503" data-postid="7815" data-belowelement="comment-494503" data-respondelement="respond" aria-label="Reply to Sabbir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494563" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-494563" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 29, 2019 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494563" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can take an existing face dataset and mask the faces using opencv or similar?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494563" data-commentid="494563" data-postid="7815" data-belowelement="comment-494563" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494651" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-494651" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/4c9807d7fef52902fb1a0ac6f08b29d2.png" srcset="https://secure.gravatar.com/avatar/4c9807d7fef52902fb1a0ac6f08b29d2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sabbir</span>
	                <span class="date">July 29, 2019 at 9:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494651" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for response. Can you refer any work or blog like your for doing mask face using opencv or similar?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494651" data-commentid="494651" data-postid="7815" data-belowelement="comment-494651" data-respondelement="respond" aria-label="Reply to Sabbir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-494718" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-494718" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">July 30, 2019 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494718" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I do not have a tutorial on this topic, perhaps in the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-494718" data-commentid="494718" data-postid="7815" data-belowelement="comment-494718" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-496218" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-496218" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/b3081880be295dd449c471a356c8081d.png" srcset="https://secure.gravatar.com/avatar/b3081880be295dd449c471a356c8081d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Al</span>
	                <span class="date">August 10, 2019 at 3:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496218" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, great tutorial.<br>
Im beginner in python.</p>
<p>I try to understand your code, and little bit confusing when you choice random example from dataset when doing classification</p>
<p>in line 28.  selection = choice([i for i in range(testX.shape[0])]),<br>
its choose random vector value in testX.shape[0] from embeddings.npz right?</p>
<p>so how if we want using spesific image from val folder?, Can you refer any work or blog to doing this</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496218" data-commentid="496218" data-postid="7815" data-belowelement="comment-496218" data-respondelement="respond" aria-label="Reply to Al">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496299" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-496299" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 11, 2019 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496299" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can see how to load an image here:<br>
<a href="https://machinelearningmastery.com/how-to-load-and-manipulate-images-for-deep-learning-in-python-with-pil-pillow/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-load-and-manipulate-images-for-deep-learning-in-python-with-pil-pillow/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496299" data-commentid="496299" data-postid="7815" data-belowelement="comment-496299" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-496458" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-496458" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/b3081880be295dd449c471a356c8081d.png" srcset="https://secure.gravatar.com/avatar/b3081880be295dd449c471a356c8081d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Al</span>
	                <span class="date">August 12, 2019 at 3:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496458" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much for the respons,</p>
<p>well I tried and it worked.</p>
<p>But I have another question, because sometime when i run the code, all worked perfectly and when I run the code again, sometime i have this error warning in load_model part although the face recognition still work</p>
<p>UserWarning: No training configuration found in save file: the model was *not* compiled. Compile it manually.<br>
  warnings.warn(‘No training configuration found in save file: ‘</p>
<p>why did this happen?</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496458" data-commentid="496458" data-postid="7815" data-belowelement="comment-496458" data-respondelement="respond" aria-label="Reply to Al">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496542" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-496542" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 13, 2019 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496542" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>
<p>You can safely ignore that warning message.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496542" data-commentid="496542" data-postid="7815" data-belowelement="comment-496542" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-496867" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-496867" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/c2f98e2e20c773c6cbd6e898887a1379.png" srcset="https://secure.gravatar.com/avatar/c2f98e2e20c773c6cbd6e898887a1379?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">August 15, 2019 at 7:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496867" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason， while I was executing the code “load_model(‘facenet_keras.h5’)”, the exception “tuple index out of range” is thrown, can you tell me why? thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496867" data-commentid="496867" data-postid="7815" data-belowelement="comment-496867" data-respondelement="respond" aria-label="Reply to Jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-496931" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-496931" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2019 at 7:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496931" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not seen that error. I have some suggestions here that may help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-496931" data-commentid="496931" data-postid="7815" data-belowelement="comment-496931" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-497735" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-497735" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/0d02e599f8442bc09ed91ba0026540db.png" srcset="https://secure.gravatar.com/avatar/0d02e599f8442bc09ed91ba0026540db?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Steve</span>
	                <span class="date">August 21, 2019 at 6:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-497735" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, again wonderful article and tutorial you provided to us. I wonder how I can customize dataset for my needs such as my friends dataset and perform training on it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-497735" data-commentid="497735" data-postid="7815" data-belowelement="comment-497735" data-respondelement="respond" aria-label="Reply to Steve">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-498654" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-498654" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/57fcddb213049a685f7a3e8a37077512.png" srcset="https://secure.gravatar.com/avatar/57fcddb213049a685f7a3e8a37077512?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hamed</span>
	                <span class="date">August 27, 2019 at 11:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498654" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason, really helpful as always but I got a weird “invalid argument” error. But I fixed it by changing ‘f’ to ‘F’ in facenet_keras.h5 because I notice it couldn’t recognize character ‘f’. Maybe because it’s trained on Ubuntu but I run your code on Windows 10. I don’t know!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498654" data-commentid="498654" data-postid="7815" data-belowelement="comment-498654" data-respondelement="respond" aria-label="Reply to Hamed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498669" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-498669" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 27, 2019 at 2:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498669" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice work!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498669" data-commentid="498669" data-postid="7815" data-belowelement="comment-498669" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498868" class="comment even depth-3 parent">

	      	<div id="li-comment-498868" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/57fcddb213049a685f7a3e8a37077512.png" srcset="https://secure.gravatar.com/avatar/57fcddb213049a685f7a3e8a37077512?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hamed</span>
	                <span class="date">August 29, 2019 at 1:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498868" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you! Dear Jason, could you please tell me how I can get access to other properties of model. I mean I don’t need model.predict. I need other properties. Is there a way to list all of them such as different convs or avgpool. I tried __dict__ and dir() but they don’t give what I want. For example, how did you know model has a property called “.predict”? Where can I find all of them? Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498868" data-commentid="498868" data-postid="7815" data-belowelement="comment-498868" data-respondelement="respond" aria-label="Reply to Hamed">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498912" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-498912" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2019 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498912" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can access all the weights via get_weights()</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498912" data-commentid="498912" data-postid="7815" data-belowelement="comment-498912" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-498823" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-498823" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/8020cca69015c993464321f84aa61444.png" srcset="https://secure.gravatar.com/avatar/8020cca69015c993464321f84aa61444?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Akash</span>
	                <span class="date">August 28, 2019 at 6:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498823" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason Can you Please post a tutorial on how to convert  David sandberg tensorflow model in keras using Hiroki Tanai script to convert it into keras</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498823" data-commentid="498823" data-postid="7815" data-belowelement="comment-498823" data-respondelement="respond" aria-label="Reply to Akash">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498890" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-498890" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2019 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498890" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498890" data-commentid="498890" data-postid="7815" data-belowelement="comment-498890" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-498842" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-498842" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/aeabdf6955d84f8595ccde7f3b141cab.png" srcset="https://secure.gravatar.com/avatar/aeabdf6955d84f8595ccde7f3b141cab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wajeeha Jamil</span>
	                <span class="date">August 28, 2019 at 9:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498842" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How can I convert this script to tensorflow lite format in order to be used in an android applicaton?? Pleaseeee helpp !!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498842" data-commentid="498842" data-postid="7815" data-belowelement="comment-498842" data-respondelement="respond" aria-label="Reply to Wajeeha Jamil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498898" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-498898" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2019 at 6:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498898" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have experience with that transform.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498898" data-commentid="498898" data-postid="7815" data-belowelement="comment-498898" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-498870" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-498870" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/5023f74cba0e7a35823365b26b0a828a.png" srcset="https://secure.gravatar.com/avatar/5023f74cba0e7a35823365b26b0a828a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jahir</span>
	                <span class="date">August 29, 2019 at 1:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498870" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This will work for many hundreds of people?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498870" data-commentid="498870" data-postid="7815" data-belowelement="comment-498870" data-respondelement="respond" aria-label="Reply to Jahir">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-498913" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-498913" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">August 29, 2019 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498913" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-498913" data-commentid="498913" data-postid="7815" data-belowelement="comment-498913" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-499730" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-499730" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d66ec21cca8af948501460269eb7340d.png" srcset="https://secure.gravatar.com/avatar/d66ec21cca8af948501460269eb7340d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://in.linkedin.com/in/saurabhbchauhan" rel="external nofollow ugc" class="url">Saurabh</a></span>
	                <span class="date">September 4, 2019 at 7:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-499730" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thanks for sharing the interesting article!</p>
<p>I have read your two articles on Face Verification: 1) this one and 2) <a href="https://machinelearningmastery.com/how-to-perform-face-recognition-with-vggface2-convolutional-neural-network-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-perform-face-recognition-with-vggface2-convolutional-neural-network-in-keras/</a></p>
<p>Which one would you suggest? If I have to develop Face Verification system then there are few approaches (listing two approaches from your article):</p>
<p>Approach 1:  Detect face using MTCNN, train VGGFACE2 on the collected dataset which helps to predict the probability of a given face belonging to a particular class</p>
<p>Approach 2: Detect face using MTCNN, get face embedding vector using facenet keras model and then apply SVM or Neural Network to predict classes</p>
<p>Which approach would you recommend? Can you please explain?</p>
<p>Thanks for sharing views.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-499730" data-commentid="499730" data-postid="7815" data-belowelement="comment-499730" data-respondelement="respond" aria-label="Reply to Saurabh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-499816" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-499816" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 5, 2019 at 6:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-499816" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps prototype a few approaches and see what works well for your specific project and requirements?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-499816" data-commentid="499816" data-postid="7815" data-belowelement="comment-499816" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-499917" class="comment even depth-3 parent">

	      	<div id="li-comment-499917" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d66ec21cca8af948501460269eb7340d.png" srcset="https://secure.gravatar.com/avatar/d66ec21cca8af948501460269eb7340d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://in.linkedin.com/in/saurabhbchauhan" rel="external nofollow ugc" class="url">Saurabh</a></span>
	                <span class="date">September 5, 2019 at 5:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-499917" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It means, I can try both approaches and have a look at efficiency, and select an approach with the best accuracy.</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-499917" data-commentid="499917" data-postid="7815" data-belowelement="comment-499917" data-respondelement="respond" aria-label="Reply to Saurabh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-500020" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-500020" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 6, 2019 at 4:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500020" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500020" data-commentid="500020" data-postid="7815" data-belowelement="comment-500020" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-499919" class="comment even depth-3 parent">

	      	<div id="li-comment-499919" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d66ec21cca8af948501460269eb7340d.png" srcset="https://secure.gravatar.com/avatar/d66ec21cca8af948501460269eb7340d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://in.linkedin.com/in/saurabhbchauhan" rel="external nofollow ugc" class="url">Saurabh</a></span>
	                <span class="date">September 5, 2019 at 5:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-499919" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>I am looking for Speech recognition tutorial on Deep Learning using Keras.</p>
<p>I have gone through your this URL: <a href="https://machinelearningmastery.com/category/deep-learning/" rel="nofollow ugc">https://machinelearningmastery.com/category/deep-learning/</a> but I couldn’t find any tutorial.</p>
<p>Could you please point to the tutorial link (if you have)?</p>
<p>Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-499919" data-commentid="499919" data-postid="7815" data-belowelement="comment-499919" data-respondelement="respond" aria-label="Reply to Saurabh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-500021" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-500021" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 6, 2019 at 4:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500021" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have tutorials on that topic, I hope to cover it in the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500021" data-commentid="500021" data-postid="7815" data-belowelement="comment-500021" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-500554" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-500554" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/9f5a13b178303c64e199ef521cf53b56.png" srcset="https://secure.gravatar.com/avatar/9f5a13b178303c64e199ef521cf53b56?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alexander</span>
	                <span class="date">September 8, 2019 at 9:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500554" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the tutorial.<br>
Unit length normalization isn’t for SVM. For SVM you typically use range scaling – MinMaxScaler, or standardization – StandardScaler. The goal is to make different features uniform. Actually, it’s a surprise that unit length normalization produced 100% accuracy in your case. That’s probably due to small data. It does not work for SVM in general and didn’t work for me.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500554" data-commentid="500554" data-postid="7815" data-belowelement="comment-500554" data-respondelement="respond" aria-label="Reply to Alexander">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-500612" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-500612" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 9, 2019 at 5:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500612" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your note.</p>
<p>I followed best practices when using face embeddings from the literature.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500612" data-commentid="500612" data-postid="7815" data-belowelement="comment-500612" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-500718" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-500718" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/79032b1b14c17ef9d206ca7374e7ce33.png" srcset="https://secure.gravatar.com/avatar/79032b1b14c17ef9d206ca7374e7ce33?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ahmad</span>
	                <span class="date">September 9, 2019 at 8:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500718" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great article. You have explained all the necessary steps to implement a face recognition system. I am working on a similar problem but in a bigger scale. I am in a belief that a classification based face identification is not a scalable solution. Please give me your opinion.</p>
<p>If I want to recognise a thousand faces in real time manner then, what type of changes do I need to make to your implementation. </p>
<p>I believe it would be really helpful if you create an article about large scale face recognition.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500718" data-commentid="500718" data-postid="7815" data-belowelement="comment-500718" data-respondelement="respond" aria-label="Reply to Ahmad">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-500791" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-500791" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 10, 2019 at 5:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500791" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, perhaps an efficient data structure like a kdtree for the pre-computed embeddings?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500791" data-commentid="500791" data-postid="7815" data-belowelement="comment-500791" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-500732" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-500732" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/aeabdf6955d84f8595ccde7f3b141cab.png" srcset="https://secure.gravatar.com/avatar/aeabdf6955d84f8595ccde7f3b141cab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wajeeha Jamil</span>
	                <span class="date">September 9, 2019 at 11:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500732" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can we extract eyes part out of the extracted face using mtcnn detector?? Any help..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500732" data-commentid="500732" data-postid="7815" data-belowelement="comment-500732" data-respondelement="respond" aria-label="Reply to Wajeeha Jamil">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-500798" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-500798" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 10, 2019 at 5:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500798" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not.</p>
<p>It will find them with a point, you can draw a circle around that point and roughly extract the eyes.</p>
<p>You might have to scale the faces/images to the same pixel size prior to modeling and extraction.</p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500798" data-commentid="500798" data-postid="7815" data-belowelement="comment-500798" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-500748" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-500748" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/76c93f9e7d70e69125c1b9f2881e4431.png" srcset="https://secure.gravatar.com/avatar/76c93f9e7d70e69125c1b9f2881e4431?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">azouz</span>
	                <span class="date">September 10, 2019 at 1:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500748" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>bonsoir monsieur pouvez vous me dire cette application peut fonctionner avec une interface tkinter qui affiche le nom et prénom et la photo reconnu</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500748" data-commentid="500748" data-postid="7815" data-belowelement="comment-500748" data-respondelement="respond" aria-label="Reply to azouz">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-500802" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-500802" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 10, 2019 at 5:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500802" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t know about “tkinter”.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-500802" data-commentid="500802" data-postid="7815" data-belowelement="comment-500802" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-501732" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-501732" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/5e5ef767971d5f9d8f6df90be041e1f4.png" srcset="https://secure.gravatar.com/avatar/5e5ef767971d5f9d8f6df90be041e1f4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhijit Kumar</span>
	                <span class="date">September 16, 2019 at 5:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-501732" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
1 . Here we are using 5 faces, what if we have thousands of faces, how to get the identity or index of those faces.</p>
<p>2. If we have fingerprints or voice which pretrained model would be most suitable.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-501732" data-commentid="501732" data-postid="7815" data-belowelement="comment-501732" data-respondelement="respond" aria-label="Reply to Abhijit Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-501797" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-501797" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 17, 2019 at 6:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-501797" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not.</p>
<p>You may need a different model for fingerprints/voice.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-501797" data-commentid="501797" data-postid="7815" data-belowelement="comment-501797" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-502005" class="comment even depth-3 parent">

	      	<div id="li-comment-502005" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/5e5ef767971d5f9d8f6df90be041e1f4.png" srcset="https://secure.gravatar.com/avatar/5e5ef767971d5f9d8f6df90be041e1f4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhijit Kumar</span>
	                <span class="date">September 18, 2019 at 3:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502005" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If I have thousands of faces, SVM takes a lot of time. What do I do to get a quick result?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502005" data-commentid="502005" data-postid="7815" data-belowelement="comment-502005" data-respondelement="respond" aria-label="Reply to Abhijit Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-502087" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-502087" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 19, 2019 at 5:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502087" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try as simpler linear model?<br>
Perhaps try running on a large EC2 instance?<br>
Perhaps try running the code in parallel?<br>
…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502087" data-commentid="502087" data-postid="7815" data-belowelement="comment-502087" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-502704" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-502704" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/bee398018a975daa820b043f6b4c432e.png" srcset="https://secure.gravatar.com/avatar/bee398018a975daa820b043f6b4c432e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">arundev</span>
	                <span class="date">September 24, 2019 at 3:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502704" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Once i have trained the model on  5 class (each class having 50 images). Now i use the model to detect images  that it has not seen, it correctly  guesses that the person in the image is class A for example with an accuracy ( prediction ) 65%. Is it possible to now add such image back to training and expect to get better results ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502704" data-commentid="502704" data-postid="7815" data-belowelement="comment-502704" data-respondelement="respond" aria-label="Reply to arundev">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-502747" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-502747" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 24, 2019 at 7:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502747" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502747" data-commentid="502747" data-postid="7815" data-belowelement="comment-502747" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-502939" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-502939" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/59fd8377fa198d661afad07d84690388.png" srcset="https://secure.gravatar.com/avatar/59fd8377fa198d661afad07d84690388?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anna</span>
	                <span class="date">September 25, 2019 at 4:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502939" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Awesome post, thanks for sharing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502939" data-commentid="502939" data-postid="7815" data-belowelement="comment-502939" data-respondelement="respond" aria-label="Reply to Anna">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503002" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-503002" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 26, 2019 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503002" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503002" data-commentid="503002" data-postid="7815" data-belowelement="comment-503002" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-502949" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-502949" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/77b0bafbd2b341b149ca56c5243f31e2.png" srcset="https://secure.gravatar.com/avatar/77b0bafbd2b341b149ca56c5243f31e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhinav</span>
	                <span class="date">September 25, 2019 at 7:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502949" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>Thanks for this tutorial. Its really helpful. I wanted to know why you used train and val dataset. I mean are these two used for training purpose. What is the use of val here.?</p>
<p>In the face classification, I am not able to understand where are you selecting the random photo to test against your dataset. How can I add my jpg photo to test again the dataset. Can you explain please. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-502949" data-commentid="502949" data-postid="7815" data-belowelement="comment-502949" data-respondelement="respond" aria-label="Reply to Abhinav">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503005" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-503005" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 26, 2019 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503005" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here, the validation set is a hold out or test set.</p>
<p>We fit on the train set, then confirm the model has skill by evaluating it on the test set (val).</p>
<p>You could add a new directory to train and val sets, to train and evaluate the model for new people.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503005" data-commentid="503005" data-postid="7815" data-belowelement="comment-503005" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503060" class="comment even depth-3 parent">

	      	<div id="li-comment-503060" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/77b0bafbd2b341b149ca56c5243f31e2.png" srcset="https://secure.gravatar.com/avatar/77b0bafbd2b341b149ca56c5243f31e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhinav</span>
	                <span class="date">September 26, 2019 at 6:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503060" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Got it. Thanks<br>
What I have seen is that in train dataset I put my pictures more than 30 images and in val dataset I put 1 image of mine for testing. So it was recognizing me fine. But when put some other person pic in val dataset, it was still recognizing it as me</p>
<p>Any idea how can this be solved</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503060" data-commentid="503060" data-postid="7815" data-belowelement="comment-503060" data-respondelement="respond" aria-label="Reply to Abhinav">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503088" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-503088" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/02425078b3b12606ddfc52ccc476e6e6.png" srcset="https://secure.gravatar.com/avatar/02425078b3b12606ddfc52ccc476e6e6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">arun</span>
	                <span class="date">September 27, 2019 at 12:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503088" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, even i  was wondering this.</p>
<p>I have trained on 30 classes with<br>
45 images in Train folder and<br>
15 images in Test folder (val)</p>
<p>after this upon testing with a new image which belongs to a class<br>
im getting good results:<br>
Image A – class A (99.996 %) which is correct<br>
Image X – class A (99.996 %) it belongs to an unkown class to the model but still it says that it belongs to class A with extremely high confidence.<br>
Any thoughts on why this occurs ??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503088" data-commentid="503088" data-postid="7815" data-belowelement="comment-503088" data-respondelement="respond" aria-label="Reply to arun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503133" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-503133" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 27, 2019 at 8:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503133" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must define the problem and model the way you intend to use it.</p>
<p>If you want the model to classify unknown people as unknown, you must give examples during training.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-503121" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-503121" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 27, 2019 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503121" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You might need to train the model on “you” vs “not-you”, or people vs unknown.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503121" data-commentid="503121" data-postid="7815" data-belowelement="comment-503121" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503166" class="comment even depth-5">

	      	<div id="li-comment-503166" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/02425078b3b12606ddfc52ccc476e6e6.png" srcset="https://secure.gravatar.com/avatar/02425078b3b12606ddfc52ccc476e6e6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">arun</span>
	                <span class="date">September 27, 2019 at 4:11 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503166" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply.<br>
Could you please explain or guide to towards the direction of<br>
“””You might need to train the model on “you” vs “not-you”, or people vs unknown.”””</p>
<p>So when we train the model, do i put  a unkown folder?<br>
like train folder :<br>
class A (30 images)<br>
class  B (30 images)<br>
unkown ???.</p>
<p>Sorry if this doesnt make sense, its a bit hard to understand what you mean by train the model on “you” vs “not-you”.</p>
<p>Help would be appriciated.</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-503213" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-503213" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 28, 2019 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503213" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, if your goal is to fit a model that can detect you, and when you show it photos of other people, it knows it’s not you, then you need a dataset of lots of photos of you and photos of other people (unknown group) so the model can learn the difference.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-503276" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-503276" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/4498803f01420644610ddec14cb06786.png" srcset="https://secure.gravatar.com/avatar/4498803f01420644610ddec14cb06786?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Parikshit</span>
	                <span class="date">September 28, 2019 at 8:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503276" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Thanks for the code. it is very helpful. </p>
<p>For a few images i am getting a error as follows</p>
<p>AttributeError: ‘JpegImageFile’ object has no attribute ‘getexif’ or<br>
AttributeError: module ‘PIL.Image’ has no attribute ‘Exif’</p>
<p>This error occurs when i use the Image.open command to import the image. </p>
<p>few examples for the images i am getting an error are as follows:</p>
<p>httpssmediacacheakpinimgcomxfecfecaefaadfebejpg.jpg (traing data for elton john)<br>
httpwwwjohnpauljonesarenacomeventimagesEltonCalendarVjpg.jpg (training data fro elton john)</p>
<p>I tried searching for this issue online but was not able to find any helpful solution. Do you have any idea how i may solve this issue? </p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503276" data-commentid="503276" data-postid="7815" data-belowelement="comment-503276" data-respondelement="respond" aria-label="Reply to Parikshit">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-503313" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-503313" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">September 29, 2019 at 6:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503313" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m sorry to hear that, I have not seen those issues before.</p>
<p>I have some suggestions here that might help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-503313" data-commentid="503313" data-postid="7815" data-belowelement="comment-503313" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-504463" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-504463" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/525e2acdc66b0a81740fce3d70486afc.png" srcset="https://secure.gravatar.com/avatar/525e2acdc66b0a81740fce3d70486afc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.schoolofai.com/" rel="external nofollow ugc" class="url">Debanik</a></span>
	                <span class="date">October 7, 2019 at 7:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504463" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>is it possible in the real-time after training?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504463" data-commentid="504463" data-postid="7815" data-belowelement="comment-504463" data-respondelement="respond" aria-label="Reply to Debanik">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504483" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-504483" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 7, 2019 at 8:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504483" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t see why not.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504483" data-commentid="504483" data-postid="7815" data-belowelement="comment-504483" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504534" class="comment even depth-3 parent">

	      	<div id="li-comment-504534" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/525e2acdc66b0a81740fce3d70486afc.png" srcset="https://secure.gravatar.com/avatar/525e2acdc66b0a81740fce3d70486afc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.school.ai/" rel="external nofollow ugc" class="url">Debanik Roy</a></span>
	                <span class="date">October 7, 2019 at 5:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504534" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>please write a programme about how it works in real-world after training?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504534" data-commentid="504534" data-postid="7815" data-belowelement="comment-504534" data-respondelement="respond" aria-label="Reply to Debanik Roy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504622" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-504622" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 8, 2019 at 7:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504622" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do you mean making a prediction after it is trained?</p>
<p>If so, the tutorial above shows that.</p>
<p>Otherwise, can you please elaborate what you mean exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504622" data-commentid="504622" data-postid="7815" data-belowelement="comment-504622" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-504578" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-504578" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/6a7e905e289424df529fd8bc783258cf.png" srcset="https://secure.gravatar.com/avatar/6a7e905e289424df529fd8bc783258cf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gabriel</span>
	                <span class="date">October 7, 2019 at 11:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504578" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Your content is so much helpful.</p>
<p>What about a system where new faces can be registered? Would I have to retrain the model, containing the new classes (new faces)?</p>
<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504578" data-commentid="504578" data-postid="7815" data-belowelement="comment-504578" data-respondelement="respond" aria-label="Reply to Gabriel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504637" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-504637" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 8, 2019 at 8:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504637" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, just create the face embeddings and fit the classification model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504637" data-commentid="504637" data-postid="7815" data-belowelement="comment-504637" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-504790" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-504790" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/3980fc782797298c6a79526211562850.png" srcset="https://secure.gravatar.com/avatar/3980fc782797298c6a79526211562850?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhishek Gupte</span>
	                <span class="date">October 9, 2019 at 7:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504790" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,<br>
First of all thank you so much for putting out the effort and organizing this tutorial! You’re truly awesome! <img draggable="false" role="img" class="emoji" alt="🙂" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1f642.svg"><br>
So I extracted facial embeddings of 3 people(6 high-quality high-resolution 5MP+ images per person as dataset )and trained them using SVM and used my built-in DELL WEBCAM(need I mention it generates a mirror image , ie my left hand appears right on the screen; also it’s a 0.3 MP 640×480 resolution feed) to identify faces.<br>
So my problem is that the probabilities are always different for the same trained face by sometimes a difference as great as 20% under the same lighting conditions! It’s mostly around 71% but sometimes dwindles to 51% for a trained face. For a stranger face it varies between 40% and 68% hence because of this variation, I can’t set a single probability value as a threshold and it’s really cumbersome.<br>
Can these differences be because of the difference in webcam quality and the dataset quality, that the algorithm has a tough time identifying the faces and varies the probability all the time, given the embeddings generated by the dataset are of much higher quality than those of the feed and also that the feed generates a mirror image of the faces in the dataset?</p>
<p>Hope this isn’t too much trouble <img draggable="false" role="img" class="emoji" alt="🙂" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1f642.svg"></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504790" data-commentid="504790" data-postid="7815" data-belowelement="comment-504790" data-respondelement="respond" aria-label="Reply to Abhishek Gupte">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504792" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-504792" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/3980fc782797298c6a79526211562850.png" srcset="https://secure.gravatar.com/avatar/3980fc782797298c6a79526211562850?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhishek Gupte</span>
	                <span class="date">October 9, 2019 at 7:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504792" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>forgot to mention, the variations in probability happen whenever I run the program on different occasions</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504792" data-commentid="504792" data-postid="7815" data-belowelement="comment-504792" data-respondelement="respond" aria-label="Reply to Abhishek Gupte">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504818" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-504818" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 9, 2019 at 8:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504818" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could also be light level, etc.</p>
<p>Try data prep that counters these issues?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504818" data-commentid="504818" data-postid="7815" data-belowelement="comment-504818" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-504817" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-504817" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 9, 2019 at 8:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504817" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it is likely the image quality.</p>
<p>Perhaps downsample the quality of all images to the same baseline level before fitting/using models?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504817" data-commentid="504817" data-postid="7815" data-belowelement="comment-504817" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504820" class="comment even depth-3 parent">

	      	<div id="li-comment-504820" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/3980fc782797298c6a79526211562850.png" srcset="https://secure.gravatar.com/avatar/3980fc782797298c6a79526211562850?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhishek Gupte</span>
	                <span class="date">October 9, 2019 at 8:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504820" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’ll do just that. Any idea how to downsample? A friend tried with same dataset but with Logitech C310 HD webcam and got a consistent probability score .It’s unlikely it’s the light level in my case as it shows variations in probability at the exact same light conditions.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504820" data-commentid="504820" data-postid="7815" data-belowelement="comment-504820" data-respondelement="respond" aria-label="Reply to Abhishek Gupte">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504837" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-504837" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 9, 2019 at 1:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I show how to resize images here:<br>
<a href="https://machinelearningmastery.com/how-to-load-and-manipulate-images-for-deep-learning-in-python-with-pil-pillow/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-load-and-manipulate-images-for-deep-learning-in-python-with-pil-pillow/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504837" data-commentid="504837" data-postid="7815" data-belowelement="comment-504837" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504931" class="comment even depth-5">

	      	<div id="li-comment-504931" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/3980fc782797298c6a79526211562850.png" srcset="https://secure.gravatar.com/avatar/3980fc782797298c6a79526211562850?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhishek Gupte</span>
	                <span class="date">October 10, 2019 at 4:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504931" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your prompt replies!<br>
Also, can mirroring the feed be the cause as I’ve mentioned my webcam does that?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-504967" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-504967" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 10, 2019 at 7:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Probably not related.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-504975" class="comment even depth-5">

	      	<div id="li-comment-504975" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/3980fc782797298c6a79526211562850.png" srcset="https://secure.gravatar.com/avatar/3980fc782797298c6a79526211562850?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhishek Gupte</span>
	                <span class="date">October 10, 2019 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504975" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Okay. One quick thing.<br>
Does both the dataset and webCam feed have to be of the same quality? Cuz I trained my face, Emma Watson and Daniel Radcliffe’s faces (their images size around 5 kb) and my image quality around 70 kb and there’s still some variation in probability</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-505005" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-505005" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 10, 2019 at 2:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505005" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Generally yes, but you can achieve the desired result by using data augmentation either during training, during testing, or both to get the model used to data of varying quality – or to downsample all images to the same quality prior to training/using the model.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-504880" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-504880" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/525e2acdc66b0a81740fce3d70486afc.png" srcset="https://secure.gravatar.com/avatar/525e2acdc66b0a81740fce3d70486afc?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://sd_intelligence/" rel="external nofollow ugc" class="url">Debanik Roy</a></span>
	                <span class="date">October 9, 2019 at 8:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504880" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir, My problem is my model is not able to distinguish between a known and unknown person in the real world.<br>
Do you have any idea about how to identify an unknown person in the real world?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504880" data-commentid="504880" data-postid="7815" data-belowelement="comment-504880" data-respondelement="respond" aria-label="Reply to Debanik Roy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-504950" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-504950" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 10, 2019 at 6:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504950" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must train the model on known and unknown people for it to learn this distinction.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-504950" data-commentid="504950" data-postid="7815" data-belowelement="comment-504950" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-505049" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-505049" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/3980fc782797298c6a79526211562850.png" srcset="https://secure.gravatar.com/avatar/3980fc782797298c6a79526211562850?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhishek Gupte</span>
	                <span class="date">October 10, 2019 at 10:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505049" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I guess it’s not really “data augmentation” when 5 out of the 6 images for Daniel radcliffe are 6KB, the last 67…and my face image quality are on average 120 KB, whereas for Emma Watson 2 out of the 3 images are 7 kb and the last 70. (The images generated by the webcam feed, the “test set” are 70 kb.). I guess both the dataset and feed should be same baseline image quality right?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505049" data-commentid="505049" data-postid="7815" data-belowelement="comment-505049" data-respondelement="respond" aria-label="Reply to Abhishek Gupte">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-505103" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-505103" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 11, 2019 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505103" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505103" data-commentid="505103" data-postid="7815" data-belowelement="comment-505103" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-505052" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-505052" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d50982a48d87577868a9aede7d7532c9.jpeg" srcset="https://secure.gravatar.com/avatar/d50982a48d87577868a9aede7d7532c9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Akhil Kumar</span>
	                <span class="date">October 10, 2019 at 11:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505052" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the great tutorial,</p>
<p>By creating a data set of 500 people of 50 images each and train the model, can I expect good accuracy regarding detection?<br>
Can I try deploying the same model on a Raspberry Pi with a Pi Camera?<br>
Can you suggest any idea about adding a new person’s face to the model once it is deployed?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505052" data-commentid="505052" data-postid="7815" data-belowelement="comment-505052" data-respondelement="respond" aria-label="Reply to Akhil Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-505105" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-505105" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 11, 2019 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505105" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try it and see?</p>
<p>Yes, compute face embeddings for new people as needed and re-fit the model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505105" data-commentid="505105" data-postid="7815" data-belowelement="comment-505105" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-505092" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-505092" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/b9a4945aeb5f1984193e465fcb32e2e2.png" srcset="https://secure.gravatar.com/avatar/b9a4945aeb5f1984193e465fcb32e2e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">RK</span>
	                <span class="date">October 11, 2019 at 5:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505092" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi!<br>
My question is that you train the network every time you want to recognise a face set.</p>
<p>How  can we train once and run it multiple times ,say like a new face set every day.</p>
<p>Is it possible to implement this in the example you have coded?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505092" data-commentid="505092" data-postid="7815" data-belowelement="comment-505092" data-respondelement="respond" aria-label="Reply to RK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-505114" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-505114" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 11, 2019 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505114" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, the network is trained once. We use face embeddings from the network as inputs to a classifier that has to be updated when new people are added.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505114" data-commentid="505114" data-postid="7815" data-belowelement="comment-505114" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-505147" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-505147" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/cb1b2e9dd207252b6cee376d3929ace9.png" srcset="https://secure.gravatar.com/avatar/cb1b2e9dd207252b6cee376d3929ace9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hai</span>
	                <span class="date">October 11, 2019 at 12:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505147" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason<br>
i run the code and add two of my own photos in both train and val dataset, SVM predict show correct class_index for my own photos in val dataset, but the SVM predict_proba show probability as below: class_index is 2(0.01181915, 0.01283217), it is the smallest value.<br>
[0.14074676 0.21515797 0.01181915 0.10075247 0.15657367 0.37494997]<br>
[0.1056123  0.20128499 0.01283217 0.1100254  0.23492927 0.33531586]</p>
<p>i see documents saying that SVM predict_proba show meanlingless result on small dataset, is it caused by that? How can i detect one-face class probability?</p>
<p>second question: can you show more code on how to train unknown people class?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505147" data-commentid="505147" data-postid="7815" data-belowelement="comment-505147" data-respondelement="respond" aria-label="Reply to Hai">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-505155" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-505155" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 11, 2019 at 1:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505155" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, SVMs cannot predict good probabilities, you must calibrate the probabilities before they can be useful:<br>
<a href="https://machinelearningmastery.com/calibrated-classification-model-in-scikit-learn/" rel="nofollow ugc">https://machinelearningmastery.com/calibrated-classification-model-in-scikit-learn/</a></p>
<p>You can add new “people” directly by computing their embeddings and using them in your model during training/testing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-505155" data-commentid="505155" data-postid="7815" data-belowelement="comment-505155" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506590" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-506590" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d66ec21cca8af948501460269eb7340d.png" srcset="https://secure.gravatar.com/avatar/d66ec21cca8af948501460269eb7340d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://in.linkedin.com/in/saurabhbchauhan" rel="external nofollow ugc" class="url">Saurabh</a></span>
	                <span class="date">October 21, 2019 at 6:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506590" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thank you again for sharing the nice blog. </p>
<p>I went through your tutorial and I got 100 train and test efficiency. Till now everything is clear.</p>
<p>But the problem arises when I apply the developed model (through your tutorial) to live frames through a webcam (my train ~700 images/class and test images ~300 images/class are captured using webcam). </p>
<p>The model does more misclassification when I apply the trained model to a frame from a webcam.</p>
<p>I am not sure how to normalize the face embedding vector in this case?</p>
<p>Could you please guide me?</p>
<p>Thanking you,<br>
Saurabh</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506590" data-commentid="506590" data-postid="7815" data-belowelement="comment-506590" data-respondelement="respond" aria-label="Reply to Saurabh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506635" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-506635" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 21, 2019 at 1:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506635" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps start with simple image preparation from here:<br>
<a href="https://machinelearningmastery.com/how-to-normalize-center-and-standardize-images-with-the-imagedatagenerator-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-normalize-center-and-standardize-images-with-the-imagedatagenerator-in-keras/</a></p>
<p>Also perhaps try alternate models for learning how to differentiate the embeddings?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506635" data-commentid="506635" data-postid="7815" data-belowelement="comment-506635" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506666" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-506666" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d66ec21cca8af948501460269eb7340d.png" srcset="https://secure.gravatar.com/avatar/d66ec21cca8af948501460269eb7340d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://in.linkedin.com/in/saurabhbchauhan" rel="external nofollow ugc" class="url">Saurabh</a></span>
	                <span class="date">October 21, 2019 at 5:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506666" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thanks for the reply. It means I should normalize the input image rather than the embedding. If the input image is normalized then I don’t need to normalize the embedding. </p>
<p>Please feel free to correct me!</p>
<p>Thanking you,<br>
Saurabh</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506666" data-commentid="506666" data-postid="7815" data-belowelement="comment-506666" data-respondelement="respond" aria-label="Reply to Saurabh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506777" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-506777" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 22, 2019 at 5:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506777" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try scaling pixels prior to using the embedding.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506777" data-commentid="506777" data-postid="7815" data-belowelement="comment-506777" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-507084" class="comment even depth-3 parent">

	      	<div id="li-comment-507084" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d66ec21cca8af948501460269eb7340d.png" srcset="https://secure.gravatar.com/avatar/d66ec21cca8af948501460269eb7340d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://in.linkedin.com/in/saurabhbchauhan" rel="external nofollow ugc" class="url">Saurabh</a></span>
	                <span class="date">October 23, 2019 at 5:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507084" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you Jason, it’s working now. Thanks for the kind help! Looking forward to grow in the Deep Learning era under your guidance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507084" data-commentid="507084" data-postid="7815" data-belowelement="comment-507084" data-respondelement="respond" aria-label="Reply to Saurabh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-507176" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-507176" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 24, 2019 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Happy to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507176" data-commentid="507176" data-postid="7815" data-belowelement="comment-507176" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506717" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-506717" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d5ec8b3c5441e4615a4a186df282dd03.png" srcset="https://secure.gravatar.com/avatar/d5ec8b3c5441e4615a4a186df282dd03?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jada</span>
	                <span class="date">October 22, 2019 at 12:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506717" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, Thank you for your tutorials, is there a method i can use to implement on the raspberry pi 3 ?</p>
<p>kind regards</p>
<p>jada</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506717" data-commentid="506717" data-postid="7815" data-belowelement="comment-506717" data-respondelement="respond" aria-label="Reply to jada">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506789" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-506789" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 22, 2019 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506789" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t know about “raspberry pi 3”.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506789" data-commentid="506789" data-postid="7815" data-belowelement="comment-506789" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506721" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-506721" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1054576571c94b26d19833d4d3a6c401.png" srcset="https://secure.gravatar.com/avatar/1054576571c94b26d19833d4d3a6c401?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HB</span>
	                <span class="date">October 22, 2019 at 12:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506721" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi, thanks for the tutorial! it was really helpful!!</p>
<p>I have followed the tutorial and got successful result with my own data set of pictures.</p>
<p>Let’s say I used person A, B, C to trained the model</p>
<p>Now I’m trying to introduce a unsorted pictures of the above 3 people(A, B, C) in one folder and sort them<br>
based on the code from your tutorial.</p>
<p>However, I can’t figure out how to introduce the new and unsorted pictures into the above code.</p>
<p>please help?</p>
<p>Thank you in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506721" data-commentid="506721" data-postid="7815" data-belowelement="comment-506721" data-respondelement="respond" aria-label="Reply to HB">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506790" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-506790" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 22, 2019 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506790" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds straightforward, what is the specific problem you’re having?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506790" data-commentid="506790" data-postid="7815" data-belowelement="comment-506790" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506820" class="comment even depth-3 parent">

	      	<div id="li-comment-506820" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1054576571c94b26d19833d4d3a6c401.png" srcset="https://secure.gravatar.com/avatar/1054576571c94b26d19833d4d3a6c401?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HB</span>
	                <span class="date">October 22, 2019 at 9:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506820" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I can’t figure out how to introduce the new unsorted pictures into the code. I tried making an npz file using the new pictures in one folder and loading them into the classifier(# load faces<br>
data = load(‘5-celebrity-faces-dataset.npz’), but the classification result was pretty bad so im assuming what i did is not correct.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506820" data-commentid="506820" data-postid="7815" data-belowelement="comment-506820" data-respondelement="respond" aria-label="Reply to HB">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506848" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-506848" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 22, 2019 at 1:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506848" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps start with the code in the tutorial and slowly adapt it for your specific dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506848" data-commentid="506848" data-postid="7815" data-belowelement="comment-506848" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506883" class="comment even depth-5">

	      	<div id="li-comment-506883" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1054576571c94b26d19833d4d3a6c401.png" srcset="https://secure.gravatar.com/avatar/1054576571c94b26d19833d4d3a6c401?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HB</span>
	                <span class="date">October 22, 2019 at 6:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506883" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think my explanation wasn’t clear enough…</p>
<p>In following the your tutorial my directory for the pictures looked like this:<br>
├── train<br>
│       ├── A : pictures of person A<br>
│       ├── B : pictures of person B<br>
│       └── C : pictures of person C<br>
│<br>
│<br>
└── val<br>
         ├── A : pictures of person A<br>
         ├── B : pictures of person B<br>
         └── C : pictures of person C<br>
and got a successful result, with let’s say<br>
“ABC_dataset.npz” &amp; “ABC_embeddings.npz”</p>
<p>So, I’m trying to one step further, and added a folder to the directory<br>
├── train<br>
 |       ├── A : pictures of person A<br>
 |       ├── B : pictures of person B<br>
 |       └── C : pictures of person C<br>
 |<br>
 |<br>
├── val<br>
 |         ├── A : pictures of person A<br>
 |         ├── B : pictures of person B<br>
 |         └── C : pictures of person C<br>
 |<br>
└── test : pictures of persons A, B, C</p>
<p>and the newly added test folder contains pictures of all A, B, C.</p>
<p>In an attempt to introduce the data from the “test” folder, </p>
<p>I extracted arrays of the faces from the pictures of the “test” folder saved the<br>
extracted arrays into an npz file, let’s say “ABC_test_dataset.npz” </p>
<p>And loaded “ABC_test_dataset.npz” into the last part of the tutorial</p>
<p># load faces<br>
data = load(‘”ABC_test_dataset.npz”‘)<br>
testX_faces = data[‘arr_2’]</p>
<p># load face embeddings<br>
data = load(‘ABC_embeddings.npz’)<br>
trainX, trainy, testX, testy = data[‘arr_0’], data[‘arr_1’], data[‘arr_2’], data[‘arr_3’]</p>
<p>and so on. </p>
<p>When I tried this, the result I got was pretty bad so I’m assuming what I did is<br>
a wrong way of introducing new dataset into the code.</p>
<p>Sorry for the VERY LONG question.<br>
Thank you!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-506979" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-506979" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2019 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506979" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the elaboration!</p>
<p>I think you’re on the right track, well done!</p>
<p>What if the cause of poor performance is the specific pictures in test? What if you swap around some of the pictures from test with those in train and see if that lifts skill?</p>
<p>What if you confirm the pipeline and add pictures from train into test and confirm they are predicted correctly – they should be?</p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-507025" class="comment even depth-5">

	      	<div id="li-comment-507025" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1054576571c94b26d19833d4d3a6c401.png" srcset="https://secure.gravatar.com/avatar/1054576571c94b26d19833d4d3a6c401?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HB</span>
	                <span class="date">October 23, 2019 at 10:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507025" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the answer!<br>
I will play with the picture data sets a bit more and tell you how it goes.</p>
<p>Last questions,<br>
1. Is it ok to use gray-scale pictures for the training? </p>
<p>2. What should be the ratio between the number of pictures in the train and val<br>
    folders?<br>
    For example, train : 1000 pics &amp; val : 100? or train : 1000 &amp; val : 50 is fine?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-507045" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-507045" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2019 at 1:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507045" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure. Try it and see.</p>
<p>Great question. I like 50/50 splits if there are enough data. I don’t want to be fooled by an optimistic result.</p>
<p>Perhaps run tests to see how sensitive the model/system is to training data size?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506737" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-506737" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/b9a4945aeb5f1984193e465fcb32e2e2.png" srcset="https://secure.gravatar.com/avatar/b9a4945aeb5f1984193e465fcb32e2e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">RK</span>
	                <span class="date">October 22, 2019 at 2:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506737" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason!<br>
I am trying to develop an attendance collector from video footage.<br>
My problem arises during the classification part,it constantly interchanges the output label names.</p>
<p>Say X and Y are two people then X is always identified as Y and vice versa.<br>
The code is error free and there is no error in the input labels.</p>
<p>How can correct this.Will this be solved if use something apart from SVM. If so what?<br>
Or should i do some fine tuning as specified in one of your earlier answers?<br>
Please guide me.</p>
<p>Awaiting your reply.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506737" data-commentid="506737" data-postid="7815" data-belowelement="comment-506737" data-respondelement="respond" aria-label="Reply to RK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506796" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-506796" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 22, 2019 at 5:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506796" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps some of the labels for these people were swapped in the training data?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506796" data-commentid="506796" data-postid="7815" data-belowelement="comment-506796" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506892" class="comment even depth-3 parent">

	      	<div id="li-comment-506892" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/b9a4945aeb5f1984193e465fcb32e2e2.png" srcset="https://secure.gravatar.com/avatar/b9a4945aeb5f1984193e465fcb32e2e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">RK</span>
	                <span class="date">October 22, 2019 at 6:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506892" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No that’s not the case.Its correct</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506892" data-commentid="506892" data-postid="7815" data-belowelement="comment-506892" data-respondelement="respond" aria-label="Reply to RK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506982" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-506982" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2019 at 6:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506982" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You may have to step through your system carefully in order to debug it. I don’t think its something obvious, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506982" data-commentid="506982" data-postid="7815" data-belowelement="comment-506982" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506898" class="comment even depth-2 parent">

	      	<div id="li-comment-506898" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d66ec21cca8af948501460269eb7340d.png" srcset="https://secure.gravatar.com/avatar/d66ec21cca8af948501460269eb7340d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://in.linkedin.com/in/saurabhbchauhan" rel="external nofollow ugc" class="url">Saurabh</a></span>
	                <span class="date">October 22, 2019 at 8:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506898" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello RK,</p>
<p>I am facing the same problem. I think there is a problem with the last model i.e. binary classification.</p>
<p>You should try comparing unknown face embedding with know face embedding.</p>
<p>I think this will help you!</p>
<p>Kindly share the output with me as I am facing a similar problem. I will also update you if I will make progress.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506898" data-commentid="506898" data-postid="7815" data-belowelement="comment-506898" data-respondelement="respond" aria-label="Reply to Saurabh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506983" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-506983" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2019 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506983" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It might be related to the label encoder. The mapping of names to labels must be consistent across code examples.</p>
<p>You can force the consistency with arguments to the encoder, or simply save the encoder object via pickle.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506983" data-commentid="506983" data-postid="7815" data-belowelement="comment-506983" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-507086" class="comment even depth-3 parent">

	      	<div id="li-comment-507086" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d66ec21cca8af948501460269eb7340d.png" srcset="https://secure.gravatar.com/avatar/d66ec21cca8af948501460269eb7340d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://in.linkedin.com/in/saurabhbchauhan" rel="external nofollow ugc" class="url">Saurabh</a></span>
	                <span class="date">October 23, 2019 at 5:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507086" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello RK,</p>
<p>Finally, I got the solution.</p>
<p>– First, extract only the face from an image using MTCNN. Please make sure to scale pixels.<br>
– Then find the face embedding using the Facenet model.<br>
– Train binary/multiclass classification model using face embedding vectors obtained in the above step.<br>
– So now you have face embedding vectors for train images and compare them with unknow encoding (a frame from webcam) using Consine or another metric.<br>
– If score &lt; threshold then face is recognized and in order to get a label, predict the class using binary/multiclass classification model trained in step 3.</p>
<p>@Jason, please feel free to correct me!</p>
<p>Thanking you,<br>
Saurabh</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507086" data-commentid="507086" data-postid="7815" data-belowelement="comment-507086" data-respondelement="respond" aria-label="Reply to Saurabh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-507178" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-507178" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 24, 2019 at 5:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507178" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Look great!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507178" data-commentid="507178" data-postid="7815" data-belowelement="comment-507178" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-506899" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-506899" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d66ec21cca8af948501460269eb7340d.png" srcset="https://secure.gravatar.com/avatar/d66ec21cca8af948501460269eb7340d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://in.linkedin.com/in/saurabhbchauhan" rel="external nofollow ugc" class="url">Saurabh</a></span>
	                <span class="date">October 22, 2019 at 8:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506899" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason has already written the blog. You can find it here: <a href="https://machinelearningmastery.com/how-to-perform-face-recognition-with-vggface2-convolutional-neural-network-in-keras/" rel="nofollow ugc">https://machinelearningmastery.com/how-to-perform-face-recognition-with-vggface2-convolutional-neural-network-in-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506899" data-commentid="506899" data-postid="7815" data-belowelement="comment-506899" data-respondelement="respond" aria-label="Reply to Saurabh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-506984" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-506984" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2019 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506984" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-506984" data-commentid="506984" data-postid="7815" data-belowelement="comment-506984" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-507130" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-507130" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/b9a4945aeb5f1984193e465fcb32e2e2.png" srcset="https://secure.gravatar.com/avatar/b9a4945aeb5f1984193e465fcb32e2e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">RK</span>
	                <span class="date">October 24, 2019 at 1:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507130" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot Saurabh!I will try implementing what you have proposed.Thanks a lot for helping.And i will also go through the blog.</p>
<p>Thank you once again Jason</p>
<p>Thanking you,<br>
RK</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507130" data-commentid="507130" data-postid="7815" data-belowelement="comment-507130" data-respondelement="respond" aria-label="Reply to RK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-507296" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-507296" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/b9a4945aeb5f1984193e465fcb32e2e2.png" srcset="https://secure.gravatar.com/avatar/b9a4945aeb5f1984193e465fcb32e2e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">RK</span>
	                <span class="date">October 24, 2019 at 6:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507296" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason!<br>
I wanted to try doing image super resolution using GANs to improve the result of my recognition process,but i’m not finding any suitable website or blog to learn from.<br>
Could you please guide.<br>
I prefer using Python for the same.<br>
Thank You!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507296" data-commentid="507296" data-postid="7815" data-belowelement="comment-507296" data-respondelement="respond" aria-label="Reply to RK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-507360" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-507360" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 25, 2019 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507360" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion, I hope to cover the topic in the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507360" data-commentid="507360" data-postid="7815" data-belowelement="comment-507360" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-507376" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-507376" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/2a1ca06e35c069231116b9e6340b6397.png" srcset="https://secure.gravatar.com/avatar/2a1ca06e35c069231116b9e6340b6397?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Virinchi</span>
	                <span class="date">October 25, 2019 at 7:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507376" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can this model differentiate between a live video of human and an picture of a human shown in front of the camera</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507376" data-commentid="507376" data-postid="7815" data-belowelement="comment-507376" data-respondelement="respond" aria-label="Reply to Virinchi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-507401" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-507401" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 25, 2019 at 1:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507401" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t know, perhaps try it out?</p>
<p>If that distinction is important to your application, I believe you could fit a model to detect “non live” examples.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507401" data-commentid="507401" data-postid="7815" data-belowelement="comment-507401" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-507429" class="comment odd alt depth-2">

	      	<div id="li-comment-507429" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/d66ec21cca8af948501460269eb7340d.png" srcset="https://secure.gravatar.com/avatar/d66ec21cca8af948501460269eb7340d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://in.linkedin.com/in/saurabhbchauhan" rel="external nofollow ugc" class="url">Saurabh</a></span>
	                <span class="date">October 25, 2019 at 6:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507429" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Virinchi,</p>
<p>This model doesn’t able to differentiate between a live video of human and a picture of a human. Bcoz this model looks for the only face, it doesn’t look for the Liveness in the face.</p>
<p>This is another research area in my view. Perhaps for the quick try, you can look whether eyes are blinking or a person is speaking to detect the Liveness. There are other techniques too.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507429" data-commentid="507429" data-postid="7815" data-belowelement="comment-507429" data-respondelement="respond" aria-label="Reply to Saurabh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-507777" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-507777" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/fecaf3d1809084bee0535e5389712f60.png" srcset="https://secure.gravatar.com/avatar/fecaf3d1809084bee0535e5389712f60?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">M Awais</span>
	                <span class="date">October 29, 2019 at 2:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507777" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Will this Work for sketch matching with real picture of that person?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507777" data-commentid="507777" data-postid="7815" data-belowelement="comment-507777" data-respondelement="respond" aria-label="Reply to M Awais">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-507806" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-507806" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 29, 2019 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507806" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try it and see?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507806" data-commentid="507806" data-postid="7815" data-belowelement="comment-507806" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-507814" class="comment even depth-3 parent">

	      	<div id="li-comment-507814" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/fecaf3d1809084bee0535e5389712f60.png" srcset="https://secure.gravatar.com/avatar/fecaf3d1809084bee0535e5389712f60?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">M Awais</span>
	                <span class="date">October 29, 2019 at 5:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507814" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>can you recommend any other method which will be good for matching sketch with picture of that person?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507814" data-commentid="507814" data-postid="7815" data-belowelement="comment-507814" data-respondelement="respond" aria-label="Reply to M Awais">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-507841" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-507841" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">October 29, 2019 at 1:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507841" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not off the cuff, perhaps start with some pre-trained models in order to create embedding and see what happens.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507841" data-commentid="507841" data-postid="7815" data-belowelement="comment-507841" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-507891" class="comment even depth-5">

	      	<div id="li-comment-507891" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/fecaf3d1809084bee0535e5389712f60.png" srcset="https://secure.gravatar.com/avatar/fecaf3d1809084bee0535e5389712f60?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">M Awais</span>
	                <span class="date">October 30, 2019 at 2:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-507891" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>ok Thanks Alot Sir</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-508656" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-508656" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/7df14518277b57463bb06dfd5425c409.png" srcset="https://secure.gravatar.com/avatar/7df14518277b57463bb06dfd5425c409?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Navi</span>
	                <span class="date">November 5, 2019 at 2:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-508656" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi jason, I am only looking at algorithm to tell if an image has face or not, face can be far, at any angle . Preesntly neiter open cv, nor any model works well, Do you know any transfer learning method to only detect if image has face or not with lot of other things in background, Some images has only body but no face, in those case it should say as no face.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-508656" data-commentid="508656" data-postid="7815" data-belowelement="comment-508656" data-respondelement="respond" aria-label="Reply to Navi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-508689" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-508689" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 5, 2019 at 6:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-508689" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try detecting and extracting the face first, then pass to a pre-trained model to get a face embedding. Perhaps try a suite of models to see which is the best for your dataset – also fit different model types on the embedding to perform the recognition.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-508689" data-commentid="508689" data-postid="7815" data-belowelement="comment-508689" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-509263" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-509263" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/cd9c7b488063b549350955927da9243d.jpeg" srcset="https://secure.gravatar.com/avatar/cd9c7b488063b549350955927da9243d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Parul Mishra</span>
	                <span class="date">November 9, 2019 at 12:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-509263" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am trying to classify 800 celebrity faces.<br>
1-using MTCNN to extract faces<br>
2- using facenet to prepare the embedding<br>
3- using KNN to classify the faces.<br>
Problem is-Though we get neglible ‘not detection’ but we get lots of wrong detection.<br>
Is there any solution to reduce the wrong detection.<br>
Other combination of pipeline used-<br>
1-MTCNN+Facenet+SVM<br>
2-One shot learning<br>
3-Also tried regularisation,data augmentation.<br>
(used 100 faces per face)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-509263" data-commentid="509263" data-postid="7815" data-belowelement="comment-509263" data-respondelement="respond" aria-label="Reply to Parul Mishra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-509311" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-509311" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 9, 2019 at 6:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-509311" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sounds like a great project!</p>
<p>Perhaps test different models?<br>
Perhaps test different data preparation?<br>
Perhaps review the errors and see if there is commonality?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-509311" data-commentid="509311" data-postid="7815" data-belowelement="comment-509311" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-512002" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-512002" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/e4e75cbc7261fd86a07c8c23e52ab905.png" srcset="https://secure.gravatar.com/avatar/e4e75cbc7261fd86a07c8c23e52ab905?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mustafa</span>
	                <span class="date">November 23, 2019 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-512002" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks for this amazing work<br>
can i use this trained model in android application ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-512002" data-commentid="512002" data-postid="7815" data-belowelement="comment-512002" data-respondelement="respond" aria-label="Reply to Mustafa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-512126" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-512126" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">November 24, 2019 at 9:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-512126" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome!</p>
<p>Perhaps try it and see.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-512126" data-commentid="512126" data-postid="7815" data-belowelement="comment-512126" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-513466" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-513466" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/e2db5cf5c85082be34356a6101d75633.png" srcset="https://secure.gravatar.com/avatar/e2db5cf5c85082be34356a6101d75633?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhinav Reddy K</span>
	                <span class="date">December 3, 2019 at 3:45 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-513466" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey!<br>
In the Keras FaceNet Pre-Trained Model (88 megabytes) you have mentioned, how should it be downloaded, it has 2 files models and weights and each has “.h5” file. Could you please tell me which has to be downloaded.<br>
I have tried both, but the code is not getting executed, it is stopping after load_model()</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-513466" data-commentid="513466" data-postid="7815" data-belowelement="comment-513466" data-respondelement="respond" aria-label="Reply to Abhinav Reddy K">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-513547" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-513547" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 4, 2019 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-513547" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Download the model, not the standalone weights.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-513547" data-commentid="513547" data-postid="7815" data-belowelement="comment-513547" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-513672" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-513672" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/e4e75cbc7261fd86a07c8c23e52ab905.png" srcset="https://secure.gravatar.com/avatar/e4e75cbc7261fd86a07c8c23e52ab905?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mustafa</span>
	                <span class="date">December 5, 2019 at 1:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-513672" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hey!<br>
how can i detect all faces in the pic ? this one takes only the first face</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-513672" data-commentid="513672" data-postid="7815" data-belowelement="comment-513672" data-respondelement="respond" aria-label="Reply to Mustafa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-513707" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-513707" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 5, 2019 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-513707" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can adapt the example to operate on all faces. I don’t have the capacity to make this change for you, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-513707" data-commentid="513707" data-postid="7815" data-belowelement="comment-513707" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514086" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-514086" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/3c75e277e614eec1e74ff6c99cce670f.png" srcset="https://secure.gravatar.com/avatar/3c75e277e614eec1e74ff6c99cce670f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ali</span>
	                <span class="date">December 7, 2019 at 11:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-514086" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks for the amazing work  sir </p>
<p>Is it normal to get F1 score =1 ? and i expanded the dataset to be like 250 pics pf 15 persons<br>
and im getting this :</p>
<p>accuracy: train=100.000, test=100.000<br>
              precision    recall  f1-score   support</p>
<p>           0       1.00      1.00      1.00         6<br>
           1       1.00      1.00      1.00         6<br>
           2       1.00      1.00      1.00         6<br>
           3       1.00      1.00      1.00         6<br>
           4       1.00      1.00      1.00         5<br>
           5       1.00      1.00      1.00         5<br>
           6       1.00      1.00      1.00         5<br>
           7       1.00      1.00      1.00         5<br>
           8       1.00      1.00      1.00         5</p>
<p>    accuracy                           1.00        49<br>
   macro avg       1.00      1.00      1.00        49<br>
weighted avg       1.00      1.00      1.00        49</p>
<p>is it okay to be 100% correct ?</p>
<p>also what other algorithms can i use to make comparison with SVC ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-514086" data-commentid="514086" data-postid="7815" data-belowelement="comment-514086" data-respondelement="respond" aria-label="Reply to Ali">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514152" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-514152" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 8, 2019 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-514152" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, if the prediction problem is trivial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-514152" data-commentid="514152" data-postid="7815" data-belowelement="comment-514152" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-514505" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-514505" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/5310fa3fd50c42c62594a10a4f50cc06.png" srcset="https://secure.gravatar.com/avatar/5310fa3fd50c42c62594a10a4f50cc06?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Manjusha</span>
	                <span class="date">December 11, 2019 at 4:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-514505" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey!</p>
<p>Can I use this for real=time applications using raspberry pi?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-514505" data-commentid="514505" data-postid="7815" data-belowelement="comment-514505" data-respondelement="respond" aria-label="Reply to Manjusha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-514539" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-514539" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 11, 2019 at 7:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-514539" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps. I don’t know about raspberry pi.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-514539" data-commentid="514539" data-postid="7815" data-belowelement="comment-514539" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-515216" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-515216" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/b55f2d4869705eb3024411bc9bfc8a2b.png" srcset="https://secure.gravatar.com/avatar/b55f2d4869705eb3024411bc9bfc8a2b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">dara</span>
	                <span class="date">December 15, 2019 at 8:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515216" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks sir<br>
What other algorithms that i can try beside the SVM ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515216" data-commentid="515216" data-postid="7815" data-belowelement="comment-515216" data-respondelement="respond" aria-label="Reply to dara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515324" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-515324" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 16, 2019 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515324" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Here are some suggestions:<br>
<a href="https://machinelearningmastery.com/hyperparameters-for-classification-machine-learning-algorithms/" rel="nofollow ugc">https://machinelearningmastery.com/hyperparameters-for-classification-machine-learning-algorithms/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515324" data-commentid="515324" data-postid="7815" data-belowelement="comment-515324" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-515286" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-515286" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/840272a71ae71b49de343ab47b8143e6.png" srcset="https://secure.gravatar.com/avatar/840272a71ae71b49de343ab47b8143e6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.rura.rw/" rel="external nofollow ugc" class="url">paga</a></span>
	                <span class="date">December 15, 2019 at 9:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515286" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello. Can any one tell me why this line is returning a None value?</p>
<p> results = detector.detect_faces(pixels)</p>
<p>Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515286" data-commentid="515286" data-postid="7815" data-belowelement="comment-515286" data-respondelement="respond" aria-label="Reply to paga">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515344" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-515344" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 16, 2019 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515344" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, this may help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515344" data-commentid="515344" data-postid="7815" data-belowelement="comment-515344" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-515750" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-515750" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/a2330c4f3cc7d5c4dd4088b5e43a1ead.png" srcset="https://secure.gravatar.com/avatar/a2330c4f3cc7d5c4dd4088b5e43a1ead?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jenny</span>
	                <span class="date">December 19, 2019 at 6:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515750" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hello , thanks for the code, it is very easy to read and go through.</p>
<p>but I am struggling to understand what you mean by</p>
<p> “No, the network is trained once. We use face embeddings from the network as inputs to a classifier that has to be updated when new people are added.”</p>
<p>so does that mean I do not need to put new person folder on the train folder? and just put the folder in the val folder and run code? </p>
<p>or do have have to rerun the code from start to end with the new people in val and train folder?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515750" data-commentid="515750" data-postid="7815" data-belowelement="comment-515750" data-respondelement="respond" aria-label="Reply to Jenny">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515798" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-515798" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 20, 2019 at 6:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515798" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You’re welcome.</p>
<p>Not sure I follow.</p>
<p>There are 2 models. The one that gives you a face embedding and one that classifies embeddings as people. The first model does not need to be retrained. The second model is only trained once and is then used to make predictions for people that it knows about (e.g. during training).</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515798" data-commentid="515798" data-postid="7815" data-belowelement="comment-515798" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515851" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-515851" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/a2330c4f3cc7d5c4dd4088b5e43a1ead.png" srcset="https://secure.gravatar.com/avatar/a2330c4f3cc7d5c4dd4088b5e43a1ead?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jenny</span>
	                <span class="date">December 20, 2019 at 2:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515851" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sorry i don’t quite understand </p>
<p>for every new person I add,<br>
 do i put the images in Train and Val folder? </p>
<p>so you mean as i have run the code throughout,<br>
i only need to run the svm part and the following code to guess the person? </p>
<p>many thanks for your response</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515851" data-commentid="515851" data-postid="7815" data-belowelement="comment-515851" data-respondelement="respond" aria-label="Reply to Jenny">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-515941" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-515941" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 21, 2019 at 7:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515941" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you have new people, you must train the SVM model on these people.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-515941" data-commentid="515941" data-postid="7815" data-belowelement="comment-515941" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516362" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-516362" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/e7723b7db5de3fe3440336123c921ed5.png" srcset="https://secure.gravatar.com/avatar/e7723b7db5de3fe3440336123c921ed5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yasser</span>
	                <span class="date">December 26, 2019 at 4:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516362" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is that posible to make embedding without prediction? Because I need to separate the train and test dataset from the picture that I want to predict</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516362" data-commentid="516362" data-postid="7815" data-belowelement="comment-516362" data-respondelement="respond" aria-label="Reply to Yasser">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516414" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-516414" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 27, 2019 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516414" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No.</p>
<p>I don’t see the problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516414" data-commentid="516414" data-postid="7815" data-belowelement="comment-516414" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516373" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-516373" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/3341c354bcbe848ce365dec8711bd1f2.png" srcset="https://secure.gravatar.com/avatar/3341c354bcbe848ce365dec8711bd1f2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">furkan</span>
	                <span class="date">December 26, 2019 at 9:19 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516373" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason. I’m new in Keras and I copied your code for see what will be. But there is an error. Please help me. Thank you.</p>
<p>Traceback (most recent call last):</p>
<p>  File “C:\Users\train\untitled0.py”, line 60, in<br>
    model_scores = get_model_scores(faces)</p>
<p>  File “C:\Users\train\untitled0.py”, line 55, in get_model_scores<br>
    return model.predict(samples)</p>
<p>  File “C:\Users\Anaconda3\lib\site-packages\keras\engine\training.py”, line 1149, in predict<br>
    x, _, _ = self._standardize_user_data(x)</p>
<p>  File “C:\Users\Anaconda3\lib\site-packages\keras\engine\training.py”, line 751, in _standardize_user_data<br>
    exception_prefix=’input’)</p>
<p>  File “C:\Users\Anaconda3\lib\site-packages\keras\engine\training_utils.py”, line 128, in standardize_input_data<br>
    ‘with shape ‘ + str(data_shape))</p>
<p>ValueError: Error when checking input: expected input_7 to have 4 dimensions, but got array with shape (2, 1, 224, 224, 3)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516373" data-commentid="516373" data-postid="7815" data-belowelement="comment-516373" data-respondelement="respond" aria-label="Reply to furkan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516417" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-516417" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 27, 2019 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516417" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, this might help:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow ugc">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516417" data-commentid="516417" data-postid="7815" data-belowelement="comment-516417" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-516427" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-516427" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/85190882085010dd400691f418178f17.png" srcset="https://secure.gravatar.com/avatar/85190882085010dd400691f418178f17?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dasha</span>
	                <span class="date">December 27, 2019 at 7:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great explanation thanks,<br>
Since it’s a biometric systems how can i find the ROC and FAR and FFR?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516427" data-commentid="516427" data-postid="7815" data-belowelement="comment-516427" data-respondelement="respond" aria-label="Reply to Dasha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-516481" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-516481" class="comment-container">

					                <div class="avatar"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(1).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow ugc" class="url">Jason Brownlee</a></span>
	                <span class="date">December 28, 2019 at 7:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>
<p>Perhaps you can use the sklearn metrics:<br>
<a href="https://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics" rel="nofollow ugc">https://scikit-learn.org/stable/modules/classes.html#sklearn-metrics-metrics</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#comment-516481" data-commentid="516481" data-postid="7815" data-belowelement="comment-516481" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#respond" style="display:none;">Click here to cancel reply.</a></small></h3><form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form"><p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="7815" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="60d1a80c2c"></p><p style="display: none;"></p><input type="hidden" id="ak_js" name="ak_js" value="1577765825654"></form>	</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><span class="left"><img alt="" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/1d75d46040c28497f0dee5d8e100db37(2).jpeg" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=170&amp;d=mm&amp;r=g 2x" class="avatar avatar-85 photo" height="85" width="85"></span>
<p></p><h4>Welcome!</h4>
My name is <em>Jason Brownlee</em> PhD, and I <strong>help developers</strong> get results with <strong>machine learning</strong>.<br>
<a href="https://machinelearningmastery.com/about">Read more</a><p></p>
<div class="fix"></div>
</div><div id="custom_html-79" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Never miss a tutorial:</h4>
<br>
<div style="text-align: left;">
<a href="https://www.linkedin.com/company/machine-learning-mastery/"><img src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/small_icon_blue_linkedin3.png" alt="LinkedIn"></a>
&nbsp;&nbsp;&nbsp;
<a href="http://twitter.com/TeachTheMachine"><img src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/small_icon_blue_twitter3.png" alt="Twitter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://www.facebook.com/MachineLearningMastery/"><img src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/small_icon_blue_facebook3.png" alt="Facebook"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/newsletter/"><img src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/small_icon_blue_email3.png" alt="Email Newsletter"></a>
&nbsp;&nbsp;&nbsp;
<a href="https://machinelearningmastery.com/rss-feed/"><img src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/small_icon_blue_rss3.png" alt="RSS Feed"></a>
</div></div></div><div id="custom_html-28" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><h4>Picked for you:</h4>
<br>
<div class="display-posts-listing image-left"><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-train-an-object-detection-model-with-keras/"><img width="150" height="150" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/Photograph-Showing-Object-Detection-Masks-Bounding-Boxes-and-Class-Labels-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Photograph Showing Object Detection Masks, Bounding Boxes, and Class Labels"></a> <a class="title" href="https://machinelearningmastery.com/how-to-train-an-object-detection-model-with-keras/" rel="nofollow">How to Train an Object Detection Model with Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/"><img width="150" height="150" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/Detected-Face-of-Jerry-Seinfeld-Correctly-Identified-by-the-SVM-Classifier-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Detected Face of Jerry Seinfeld, Correctly Identified by the SVM Classifier"></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/" rel="nofollow">How to Develop a Face Recognition System Using FaceNet in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-perform-object-detection-with-yolov3-in-keras/"><img width="150" height="150" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/Photograph-of-Three-Zebra-Each-Detected-with-the-YOLOv3-Model-and-Localized-with-Bounding-Boxes-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Photograph of Three Zebra Each Detected with the YOLOv3 Model and Localized with Bounding Boxes"></a> <a class="title" href="https://machinelearningmastery.com/how-to-perform-object-detection-with-yolov3-in-keras/" rel="nofollow">How to Perform Object Detection With YOLOv3 in Keras</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-to-classify-photos-of-dogs-and-cats/"><img width="150" height="150" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/Plot-of-the-First-Nine-Photos-of-Cats-in-the-Dogs-vs-Cats-Dataset-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Plot of the First Nine Photos of Cats in the Dogs vs Cats Dataset"></a> <a class="title" href="https://machinelearningmastery.com/how-to-develop-a-convolutional-neural-network-to-classify-photos-of-dogs-and-cats/" rel="nofollow">How to Classify Photos of Dogs and Cats (with 97% accuracy)</a></div><div class="listing-item"><a class="image" href="https://machinelearningmastery.com/how-to-configure-image-data-augmentation-when-training-deep-learning-neural-networks/"><img width="150" height="150" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/Plot-of-Augmented-Images-with-a-Horizontal-Shift-150x150.png" class="attachment-thumbnail size-thumbnail wp-post-image" alt="Plot of Augmented Generated With a Random Horizontal Shift"></a> <a class="title" href="https://machinelearningmastery.com/how-to-configure-image-data-augmentation-when-training-deep-learning-neural-networks/" rel="nofollow">How to Configure Image Data Augmentation in Keras</a></div></div></div></div><div id="custom_html-9" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><div style="text-align: center;">
	<p></p><h4>Loving the Tutorials?</h4><p></p>

<p>The <a href="https://machinelearningmastery.com/deep-learning-for-computer-vision/" rel="nofollow">Deep Learning for Computer Vision</a> EBook is where I keep the <strong><i>Really Good</i></strong> stuff.</p>
	
	<a href="https://machinelearningmastery.com/deep-learning-for-computer-vision/" class="woo-sc-button  custom" style="background:;border-color:"><span class="woo-">See What's Inside</span></a>

</div></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2019 Machine Learning Mastery Pty. Ltd. All Rights Reserved.<br>
Address: PO Box 206, Vermont Victoria 3133, Australia. | ACN: 626 223 336.<br>
<a href="https://www.linkedin.com/company/machine-learning-mastery/">LinkedIn</a> |
<a href="http://twitter.com/TeachTheMachine">Twitter</a> |
<a href="https://www.facebook.com/MachineLearningMastery/">Facebook</a> |
<a href="https://machinelearningmastery.com/newsletter/">Newsletter</a> |
<a href="https://machinelearningmastery.com/rss-feed/">RSS</a></p>		</div>

		<div id="credit" class="col-right">
			<p><a href="https://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="https://machinelearningmastery.com/disclaimer/">Disclaimer</a> | 
<a href="https://machinelearningmastery.com/terms-of-service/">Terms</a> | 
<a href="https://machinelearningmastery.com/contact/">Contact</a> |
<a href="https://machinelearningmastery.com/sitemap/">Sitemap</a> |
<a href="https://machinelearningmastery.com/site-search/">Search</a></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><script type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/comment-reply.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"cached":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/scripts.js"></script>
<script type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/wp-embed.min.js"></script>
<script async="async" type="text/javascript" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/form.js"></script>
<script type="text/javascript">		
		document.addEventListener("DOMContentLoaded", function() {
			var if_ssb_exist = document.getElementsByClassName( "simplesocialbuttons" ).length > 0;
			if (if_ssb_exist) {
				var ssb_admin_ajax = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
				var ssb_post_id = 7815 ;
				var ssb_post_url = 'https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/';
				var ssb_alternate_post_url = 'http://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/';
				jQuery( document ).ready(function(){
				var is_ssb_used = jQuery('.simplesocialbuttons');
				if( is_ssb_used ) {

					var data = {
					'action': 'ssb_fetch_data',
					'postID': ssb_post_id
				};
					jQuery.post(ssb_admin_ajax, data, function(data, textStatus, xhr) {
						var array = JSON.parse(data);
						console.log( array );
						jQuery.each( array, function( index, value ){

							if( index == 'total' ){
								jQuery('.ssb_'+ index +'_counter').html(value + '<span>Shares</span>');
							}else{
								jQuery('.ssb_'+ index +'_counter').html(value);
							}
						});

					});
				}
				})

			//	ssbPlugin.fetchFacebookShares();
			}
		});


		</script><script type="text/javascript">function initTwitCount(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs)}}
        var ssb_twit_count_init=!1;addEventListener('mouseover',function(event){if(!ssb_twit_count_init){initTwitCount(document,'script','twitcount_plugins')
        ssb_twit_count_init=!0}})</script>
<div style="position: absolute; right: 0px; left: 0px; bottom: 0px; top: 0px; z-index: 2147483646; background: black; width: 100%; opacity: 0.5; display: none; height: 51350px;"></div><iframe src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/saved_resource.html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 914px;"></iframe><iframe src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/saved_resource(1).html" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: none; z-index: 2147483647; height: 914px;"></iframe><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab no-image classic bottom right">
    <div id="drip-header-2211" class="drip-header">
      <a href="https://machinelearningmastery.com/how-to-develop-a-face-recognition-system-using-facenet-in-keras-and-an-svm-classifier/#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Start Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: -496px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Start Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without math or fancy degrees</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em>&nbsp;course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input type="hidden" name="form_id" value="2211">
            </div>
            <dl class="no-labels">
              
                
                  <dt>Email Address</dt>
                  <dd class="drip-clearfix">
                    
                      <input type="email" name="fields[email]" value="" placeholder="Email Address" class="drip-text-field">
                      <div id="drip-errors-for-email-2211" class="drip-errors"></div>
                    
                  </dd>
                
              
                
                  <dt></dt>
                  <dd class="drip-clearfix">
                    
                      <div class="classic--checkbox hidden" data-container="eu-checkbox">
                        <input type="hidden" name="fields[eu_consent]" id="drip-field-eu_consent-2211-denied" value="denied" disabled="disabled">
                        <input type="checkbox" name="fields[eu_consent]" id="drip-field-eu_consent-2211" value="granted" disabled="disabled">
                        <label for="drip-field-eu_consent-2211">I consent to receive information about services and special offers by email. For more information, see the <a href="https://machinelearningmastery.com/privacy/">Privacy Policy</a>.</label>
                      </div>
                    
                  </dd>
                
              
                
                  <input type="hidden" name="fields[eu_consent_message]" value="I consent to receive information about services and special offers by email. For more information, see the Privacy Policy (https://machinelearningmastery.com/privacy/).">
                
              
              
              <div style="display: none;" aria-hidden="true">
                <dt for="website">Website</dt>
                <dd>
                  <input type="text" id="website" name="website" placeholder="Website" class="drip-text-field" tabindex="-1" autocomplete="false" value="">
                </dd>
              </div>
            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button">
            </div>
          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>

      
    </div>
  </div>
</div><iframe scrolling="no" frameborder="0" allowtransparency="true" src="../How%20to%20Develop%20a%20Face%20Recognition%20System%20Using%20FaceNet%20in%20Keras_files/widget_iframe.69e02060c7c44baddf1b5629549acc0c.html" title="Twitter settings iframe" style="display: none;"></iframe></body></html>